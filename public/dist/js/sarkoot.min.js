const aside = document.querySelector('#aside');
const asideBtn = document.querySelector('#aside-btn');
function handleAside(event) {
    aside.classList.add('open');
}
asideBtn.addEventListener('click', handleAside);

const profile = document.querySelector('.profile');
const dropdown = document.querySelector('.profile-dropdown');

function handleProfileClick(event) {
    dropdown.classList.add('open');
}

profile.addEventListener('click', handleProfileClick);
window.addEventListener('click', function(event) {
    if (!event.target.closest('.profile-div')) {
        dropdown.classList.remove('open');
    }
    if (!event.target.closest('#aside') && !event.target.closest('#aside-btn')) {
        aside.classList.remove('open');
    }
});

am4core.ready(function () {

    // Themes begin
    am4core.useTheme(am4themes_amcharts);
    // Themes end

    // Create chart instance
    var chart = am4core.create("chartdiv", am4charts.XYChart);

    chart.rtl = true;

    // Add data
    chart.data = [{
        "country": "USA",
        "visits": 2025
    }, {
        "country": "China",
        "visits": 1882
    }, {
        "country": "Japan",
        "visits": 1809
    }, {
        "country": "Germany",
        "visits": 1322
    }, {
        "country": "UK",
        "visits": 1122
    }, {
        "country": "France",
        "visits": 1114
    }, {
        "country": "India",
        "visits": 984
    }, {
        "country": "Spain",
        "visits": 711
    }, {
        "country": "Netherlands",
        "visits": 665
    }, {
        "country": "Russia",
        "visits": 580
    }, {
        "country": "South Korea",
        "visits": 443
    }, {
        "country": "Canada",
        "visits": 441
    }, {
        "country": "Brazil",
        "visits": 395
    }];

    // Create axes

    var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
    categoryAxis.dataFields.category = "country";
    categoryAxis.renderer.grid.template.location = 0;
    categoryAxis.renderer.minGridDistance = 30;

    categoryAxis.renderer.labels.template.adapter.add("dy", function (dy, target) {
        if (target.dataItem && target.dataItem.index & 2 == 2) {
            return dy + 25;
        }
        return dy;
    });

    var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());

    // Create series
    var series = chart.series.push(new am4charts.ColumnSeries());
    series.dataFields.valueY = "visits";
    series.dataFields.categoryX = "country";
    series.name = "Visits";
    series.columns.template.tooltipText = "{categoryX}: [bold]{valueY}[/]";
    series.columns.template.fillOpacity = .8;

    var columnTemplate = series.columns.template;
    columnTemplate.strokeWidth = 2;
    columnTemplate.strokeOpacity = 1;

}); // end am4core.ready()

$(document).ready(function() {
    $('.select2').select2();
});

function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function(e) {
            $(input).next('label').children('img').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
  }

$('.input-avatar').change(function() {
    readURL(this);
});

var datepicker = function (elementID, opt) {

    // check arguments
    if (typeof elementID !== "string" || elementID.length === 0) {
        console.error("datepicker error: input ID is not string or is empty");
        return;
    }
    var options = opt || {};

    // variables
    var isCalClicked = false;
    var isSynced = false;

    var dayOfWeek;

    var selectedYear;
    var selectedMonth;
    var selectedDay;

    var currentYear;
    var currentMonth;
    var currentDay;

    var todaysYear;
    var todaysMonth;
    var todaysDay;

    var dayOfWeekJ;

    var numberOfDays;

    var todayG;
    var todaysJ;

    // consts
    var MONTH_NAMES = {
        "1": "فروردین"
        , "2": "اردیبهشت"
        , "3": "خرداد"
        , "4": "تیر"
        , "5": "مرداد"
        , "6": "شهریور"
        , "7": "مهر"
        , "8": "آبان"
        , "9": "آذر"
        , "10": "دی"
        , "11": "بهمن"
        , "12": "اسفند"
    }
    var DAY_NAMES = {
        "شنبه": "ش"
        , "یکشنبه": "ی"
        , "دوشنبه": "د"
        , "سه شنبه": "س"
        , "چهارشنبه": "چ"
        , "پنج شنبه": "پ"
        , "جمعه": "ج"
    };
    var FA_NUMS = ['٠', '١', '٢', '٣', '۴', '۵', '۶', '٧', '٨', '٩', '١٠', '١١', '١٢', '١٣', '١۴', '١۵', '١۶', '١٧', '١٨', '١٩', '٢٠', '٢١', '٢٢', '٢٣', '٢۴', '٢۵', '٢۶', '٢٧', '٢٨', '٢٩', '٣٠', '٣١', '٣٢'];

    // set options
    options.placeholder = options.placeholder !== undefined ? options.placeholder : "";
    options.twodigit = options.twodigit !== undefined ? options.twodigit : true;
    options.closeAfterSelect = options.closeAfterSelect !== undefined ? options.closeAfterSelect : true;
    options.nextButtonIcon = options.nextButtonIcon !== undefined ? options.nextButtonIcon : false;
    options.previousButtonIcon = options.previousButtonIcon !== undefined ? options.previousButtonIcon : false;
    options.buttonsColor = options.buttonsColor !== undefined ? options.buttonsColor : false;
    options.forceFarsiDigits = options.forceFarsiDigits !== undefined ? options.forceFarsiDigits : false;
    options.markToday = options.markToday !== undefined ? options.markToday : false;
    options.markHolidays = options.markHolidays !== undefined ? options.markHolidays : false;
    options.highlightSelectedDay = options.highlightSelectedDay !== undefined ? options.highlightSelectedDay : false;
    options.sync = options.sync !== undefined ? options.sync : false;
    options.gotoToday = options.gotoToday !== undefined ? options.gotoToday : false;

    // create DOM
    var inputElement = $("#" + elementID);

    if (inputElement.attr("placeholder") === undefined) {
        inputElement.attr("placeholder", options.placeholder);
    }

    // create parent div
    inputElement.wrap("<div id='bd-root-" + elementID + "' style='position: relative;'></div>");

    // create main div for calendar, below input element
    inputElement.after("<div id='bd-main-" + elementID + "' class='bd-main bd-hide' style='position: absolute; direction: rtl;'></div>");
    var mainDiv = $("#bd-main-" + elementID);

    // create calendar div inside main div
    mainDiv.append("<div class='bd-calendar'></div>");
    var calendarDiv = mainDiv.find('.bd-calendar');

    // create title div and table inside calendar div
    calendarDiv.append("<div class='bd-title'></div>");
    var titleDiv = calendarDiv.find('.bd-title');
    calendarDiv.append("<table class='bd-table' dir='rtl' cellspacing='0' cellpadding='0'></table>");

    // create month and year drop downs and next/prev month buttons inside title div
    titleDiv.append("<button id='bd-next-" + elementID + "' class='bd-next' type='button' title='ماه بعدی' data-toggle='tooltip'><span>بعدی</span></button>");
    var nextMonth = $("#bd-next-" + elementID);
    if (options.nextButtonIcon) {
        nextMonth.find("span").css("display", "none");
        if (options.nextButtonIcon.indexOf(".") !== -1) {
            // image
            nextMonth.css("background-image", "url(" + options.nextButtonIcon + ")");
        } else {
            // css class
            nextMonth.addClass(options.nextButtonIcon);
        }
    }

    titleDiv.append("<div class='bd-dropdown'></div><div class='bd-dropdown'></div>");

    titleDiv.find('.bd-dropdown:nth-child(2)').append("<select id='bd-month-" + elementID + "' class='bd-month'></select>");
    var monthDropdown = $("#bd-month-" + elementID);
    $.each(MONTH_NAMES, function (key, value) {
        monthDropdown.append($("<option></option>").attr("value", key).text(value));
    });

    titleDiv.find('.bd-dropdown:nth-child(3)').append("<select id='bd-year-" + elementID + "' class='bd-year'></select>");
    var yearDropdown = $("#bd-year-" + elementID);

    titleDiv.append("<button id='bd-prev-" + elementID + "' class='bd-prev' type='button' title='ماه قبلی' data-toggle='tooltip'><span>قبلی</span></button>");
    var prevMonth = $("#bd-prev-" + elementID);
    if (options.nextButtonIcon) {
        prevMonth.find("span").css("display", "none");
        if (options.previousButtonIcon.indexOf(".") !== -1) {
            // image
            prevMonth.css("background-image", "url(" + options.previousButtonIcon + ")");
        } else {
            // css class
            prevMonth.addClass(options.previousButtonIcon);
        }
    }

    if (options.buttonsColor) {
        nextMonth.css("color", options.buttonsColor);
        nextMonth.find("span").css("color", options.buttonsColor);
        prevMonth.css("color", options.buttonsColor);
        prevMonth.find("span").css("color", options.buttonsColor);
    }

    // create table header and body
    calendarDiv.find('.bd-table').append("<thead><tr></tr></thead>");
    $.each(DAY_NAMES, function (key, value) {
        calendarDiv.find('.bd-table thead tr').append($("<th></th>").text(value));
    });

    calendarDiv.find('.bd-table').append("<tbody id='bd-table-days-" + elementID + "' class='bd-table-days'></tbody>");
    var daysTable = $("#bd-table-days-" + elementID);

    // create go to todays button
    if (options.gotoToday) {
        calendarDiv.append("<div class='bd-goto-today'>برو به امروز</div>");
        var gotoToday = calendarDiv.find(".bd-goto-today");
    }

    // opening and closing functionality
    inputElement.on("focus", function () {
        mainDiv.removeClass("bd-hide");
        if (options.sync && isSynced === false) {
            syncCalendar();
            isSynced = true;
        }
        mainDiv;
    }).on('blur', function () {
        if (isCalClicked == false) {
            mainDiv.addClass("bd-hide");
            isSynced = false;
        } else {
            isCalClicked = false;
            inputElement.focus();
            event.preventDefault();
        }
    });

    mainDiv.on('mousedown', function (event) {
        isCalClicked = true;
    });

    // dropdown events
    monthDropdown.on('change', function () {
        selectedMonth = parseInt(this.value);
        numberOfDays = monthDays(selectedYear, selectedMonth);
        dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);
        drawDays(numberOfDays, dayOfWeekJ);
    });
    yearDropdown.on('change', function () {
        selectedYear = parseInt(this.value);
        numberOfDays = monthDays(selectedYear, selectedMonth);
        dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);
        drawDays(numberOfDays, dayOfWeekJ);
    });

    // Georgian to Jalali converter (minified)
    // source is unknown. contact if you know the code owner.
    function gregorianToJalali(a, r, s) { a = parseInt(a), r = parseInt(r), s = parseInt(s); for (var n = a - 1600, e = r - 1, t = s - 1, p = 365 * n + parseInt((n + 3) / 4) - parseInt((n + 99) / 100) + parseInt((n + 399) / 400), I = 0; e > I; ++I) p += g_days[I]; e > 1 && (n % 4 == 0 && n % 100 != 0 || n % 400 == 0) && ++p, p += t; var v = p - 79, d = parseInt(v / 12053); v %= 12053; var o = 979 + 33 * d + 4 * parseInt(v / 1461); v %= 1461, v >= 366 && (o += parseInt((v - 1) / 365), v = (v - 1) % 365); for (var I = 0; 11 > I && v >= j_days[I]; ++I) v -= j_days[I]; var y = I + 1, _ = v + 1; return [o, y, _] } var g_days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], j_days = [31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29];
    // Jalali to Georgian converter (minified)
    // source is unknown. contact if you know the code owner.
    function toJalaali(d, i, a) { return d2j(g2d(d, i, a)) } function toGregorian(d, i, a) { return d2g(j2d(d, i, a)) } function isValidJalaaliDate(d, i, a) { return d >= -61 && 3177 >= d && i >= 1 && 12 >= i && a >= 1 && a <= jalaaliMonthLength(d, i) } function isLeapJalaaliYear(d) { return 0 === jalCal(d).leap } function jalaaliMonthLength(d, i) { return 6 >= i ? 31 : 11 >= i ? 30 : isLeapJalaaliYear(d) ? 30 : 29 } function jalCal(d) { var i, a, n, r, t, o, v, e = [-61, 9, 38, 199, 426, 686, 756, 818, 1111, 1181, 1210, 1635, 2060, 2097, 2192, 2262, 2324, 2394, 2456, 3178], l = e.length, u = d + 621, m = -14, g = e[0]; if (g > d || d >= e[l - 1]) throw new Error("Invalid Jalaali year " + d); for (v = 1; l > v && (i = e[v], a = i - g, !(i > d)); v += 1) m = m + 8 * div(a, 33) + div(mod(a, 33), 4), g = i; return o = d - g, m = m + 8 * div(o, 33) + div(mod(o, 33) + 3, 4), 4 === mod(a, 33) && a - o === 4 && (m += 1), r = div(u, 4) - div(3 * (div(u, 100) + 1), 4) - 150, t = 20 + m - r, 6 > a - o && (o = o - a + 33 * div(a + 4, 33)), n = mod(mod(o + 1, 33) - 1, 4), -1 === n && (n = 4), { leap: n, gy: u, march: t } } function j2d(d, i, a) { var n = jalCal(d); return g2d(n.gy, 3, n.march) + 31 * (i - 1) - div(i, 7) * (i - 7) + a - 1 } function d2j(d) { var i, a, n, r = d2g(d).gy, t = r - 621, o = jalCal(t), v = g2d(r, 3, o.march); if (n = d - v, n >= 0) { if (185 >= n) return a = 1 + div(n, 31), i = mod(n, 31) + 1, { jy: t, jm: a, jd: i }; n -= 186 } else t -= 1, n += 179, 1 === o.leap && (n += 1); return a = 7 + div(n, 30), i = mod(n, 30) + 1, { jy: t, jm: a, jd: i } } function g2d(d, i, a) { var n = div(1461 * (d + div(i - 8, 6) + 100100), 4) + div(153 * mod(i + 9, 12) + 2, 5) + a - 34840408; return n = n - div(3 * div(d + 100100 + div(i - 8, 6), 100), 4) + 752 } function d2g(d) { var i, a, n, r, t; return i = 4 * d + 139361631, i = i + 4 * div(3 * div(4 * d + 183187720, 146097), 4) - 3908, a = 5 * div(mod(i, 1461), 4) + 308, n = div(mod(a, 153), 5) + 1, r = mod(div(a, 153), 12) + 1, t = div(i, 1461) - 100100 + div(8 - r, 6), { gy: t, gm: r, gd: n } } function div(d, i) { return ~~(d / i) } function mod(d, i) { return d - ~~(d / i) * i }

    var syncCalendar = function () {
        var inputValue = fixDate(inputElement.val());
        if (inputValue === "")
            return;

        inputValue = inputValue.split("/");
        monthDropdown.val(parseInt(inputValue[1]));
        monthDropdown.trigger("change");
        yearDropdown.val(parseInt(inputValue[0]));
        yearDropdown.trigger("change");

        if (options.highlightSelectedDay) {
            mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
            mainDiv.find(".day-" + parseInt(inputValue[2])).addClass("bd-selected-day");
        }
    }

    var fixDate = function (date) {
        if (date === "")
            return "";

        date = date.split("/");
        // if (date[0].length === 2) {
        //     date[0] = "13" + date[0];
        // }
        if (date[1].length < 2) {
            if (date[1] < 10) {
                date[1] = "0" + date[1];
            }
        }
        if (date[2].length < 2) {
            if (date[2] < 10) {
                date[2] = "0" + date[2];
            }
        }
        date = date.join("/");
        return date;
    }

    var convertToJWeek = function (dayOfWeekG) {
        var dayOfWeekJ;
        if (dayOfWeekG < 6) {
            dayOfWeekJ = dayOfWeekG + 1;
        } else {
            dayOfWeekJ = 0;
        }
        return dayOfWeekJ;
    }

    var makeYearList = function (thisYear) {
        yearDropdown.find('option').remove();
        for (i = 0; i < 101; i++) {
            var tempYear = ((thisYear - 95) + i) + '';
            if (options.forceFarsiDigits) {
                for (var j = 0; j < 10; j++) {
                    var rgx = new RegExp(j, 'g');
                    tempYear = tempYear.replace(rgx, FA_NUMS[j]);
                }
            }
            yearDropdown.append($('<option>', {
                value: (thisYear - 95) + i,
                text: tempYear
            }));
        }
    }

    // isleap calculator, supported year: 1243 - 1473
    var isLeapYear = function (year) {
        var mod;
        if (year < 1343 && year > 1243) {
            mod = year % 33;
            if (mod == 1 || mod == 5 || mod == 9 || mod == 13 || mod == 17 || mod == 22 || mod == 26 || mod == 30) {
                return true;
            } else {
                return false;
            }
        } else if (year < 1473 && year > 1342) {
            mod = year % 17;
            if (mod == 1 || mod == 5 || mod == 9 || mod == 13 || mod == 18 || mod == 22 || mod == 26 || mod == 30) {
                return true;
            } else {
                return false
            }
        } else {
            return "unknown";
        }
    }

    var monthDays = function (year, month) {
        if (month < 7) {
            return 31;
        } else if (month < 12) {
            return 30;
        } else {
            if (isLeapYear(year)) {
                return 30;
            } else {
                return 29;
            }
        }
    }

    // make first page of calendar
    todayG = new Date();

    todaysJ = gregorianToJalali(todayG.getFullYear(), todayG.getMonth() + 1, todayG.getDate());
    var selectedDateJ = [];
    for (i = 0; i < 3; i++) {
        selectedDateJ[i] = todaysJ[i];
    }

    todaysYear = todaysJ[0];
    todaysMonth = todaysJ[1];
    todaysDay = todaysJ[2];

    selectedYear = selectedDateJ[0];
    selectedMonth = selectedDateJ[1];
    selectedDay = selectedDateJ[2];

    monthDropdown.val(selectedMonth);
    makeYearList(selectedYear);
    yearDropdown.val(selectedYear);

    numberOfDays = monthDays(selectedYear, selectedMonth);

    // find first day of month in week
    var findFirstDayOfMonth = function (selectedYear, selectedMonth) {
        var firstDayOfMonthG = toGregorian(selectedYear, selectedMonth, 1);
        firstDayOfMonthG = new Date(firstDayOfMonthG.gy + "/" + firstDayOfMonthG.gm + "/" + firstDayOfMonthG.gd);
        return convertToJWeek(firstDayOfMonthG.getDay());
    }
    dayOfWeekJ = findFirstDayOfMonth(selectedYear, selectedMonth);

    // draw days on calendar
    var drawDays = function (numberOfDays, dayOfWeekJ) {
        daysTable.empty();
        var dayIndex = 1;
        var rowIndex = 1;
        while (dayIndex <= numberOfDays) {
            daysTable.append($('<tr>', {
                class: "tr-" + rowIndex
            }));
            for (i = 0; i < 7; i++) {
                if (dayIndex == 1) {
                    var j = 0;
                    while (j < dayOfWeekJ) {
                        $("#bd-table-days-" + elementID + " .tr-1").append($('<td>', {
                            class: "bd-empty-cell"
                        })
                        );
                        j++;
                        i++;
                    }
                }
                if (i < 7 && dayIndex <= numberOfDays) {
                    var tempTD = '<td>' +
                        '<button class="day day-' + dayIndex + '" type="button">' + (options.forceFarsiDigits ? FA_NUMS[dayIndex] : dayIndex) + '</button>' +
                        '</td>';

                    // mark todays day by adding .bd-today class
                    if (options.markToday) {
                        if (dayIndex == todaysDay && todaysMonth == selectedMonth && todaysYear == selectedYear) {
                            var idx = tempTD.indexOf('day day-');
                            tempTD = tempTD.slice(0, idx) + ' bd-today ' + tempTD.slice(idx);
                        }
                    }

                    // mark holidays by adding .bd-holiday class
                    if (options.markHolidays) {
                        if (i == 6) {
                            var idx = tempTD.indexOf('day day-');
                            tempTD = tempTD.slice(0, idx) + ' bd-holiday ' + tempTD.slice(idx);
                        }
                    }

                    $("#bd-table-days-" + elementID + " .tr-" + rowIndex).append(tempTD);

                    dayIndex++;
                }
            }
            rowIndex++;
        }

        if (options.highlightSelectedDay) {
            var inputValue = inputElement.val();
            inputValue = inputValue.split("/");
            if (inputValue[0] == selectedYear && inputValue[1] == selectedMonth) {
                mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
                mainDiv.find(".day-" + parseInt(inputValue[2])).addClass("bd-selected-day");
            }
        }

    }

    inputElement.parent().on("click", "button.day", function () {
        var datestr = selectedYear + "/" + selectedMonth + "/" + $(this).attr('class').split(" ")[$(this).attr('class').split(" ").indexOf('day') + 1].split("-")[1];
        if (options.twodigit) {
            datestr = fixDate(datestr);
        }
        inputElement.val(datestr);
        inputElement.trigger("change");
        if (options.closeAfterSelect) {
            isCalClicked = false;
            inputElement.trigger("blur");
        }

        if (options.highlightSelectedDay) {
            mainDiv.find(".bd-selected-day").removeClass("bd-selected-day");
            $(this).addClass("bd-selected-day");
        }
    });

    nextMonth.on("click", function () {
        //console.log("month: " + selectedMonth + ", year: " + selectedYear);
        if (monthDropdown.val() < 12) {
            monthDropdown.val(parseInt(monthDropdown.val()) + 1);
            monthDropdown.trigger("change");
        } else {
            monthDropdown.val(1);
            monthDropdown.trigger("change");
            yearDropdown.val(parseInt(yearDropdown.val()) + 1);
            yearDropdown.trigger("change");
        }
    });

    prevMonth.on("click", function () {
        if (monthDropdown.val() > 1) {
            monthDropdown.val(parseInt(monthDropdown.val()) - 1);
            monthDropdown.trigger("change");
        } else {
            monthDropdown.val(12);
            monthDropdown.trigger("change");
            yearDropdown.val(parseInt(yearDropdown.val()) - 1);
            yearDropdown.trigger("change");
        }
    });

    if (options.gotoToday) {
        gotoToday.on("click", function () {
            monthDropdown.val(todaysMonth);
            monthDropdown.trigger("change");
            yearDropdown.val(todaysYear);
            yearDropdown.trigger("change");
        });
    }

    drawDays(numberOfDays, dayOfWeekJ);

    // enable bootstrap tooltip if bootstrap is loaded
    if (typeof $().modal == 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }

}

(function(){
	function jresp(context, res)
	{
		context.trigger('jresp', [res]);
		if (res.message && !context.is('.d-notification'))
		{
			if (window.toastr)
			{
				var toast = toastr[res.is_ok ? 'success' : 'error'](res.message_text || res.message, undefined, {
					"closeButton": true,
					"newestOnTop": true,
					"positionClass": "toast-bottom-right",
				});
			}
			else if (window.iziToast)
			{
				iziToast[res.is_ok ? 'success' : 'error']({ message: res.message_text || res.message});
			}
		}
		if(res.redirect)
		{
			if(res.direct)
			{
				location.href = res.redirect;
			}
			else
			{
				new Statio({
					url : res.redirect
				});
			}
		}
	}
	window.JResp = jresp;
})();
(function(){
	function lijax(context, onFire)
	{
        var back_value = $(context).val() || $(context).attr('data-value');
        if($(context).is(':checkbox'))
        {
            back_value = $(context).is(':checked') ? 1 : 0;
        }
        var Timeout = null;
        var fire = null;
        if($(context).is('form') && !$(context).attr('data-lijax'))
        {
            fire = ['submit'];
        }
        else
        {
            fire = $(context).attr('data-lijax').split(' ') || ['change'];
        }
        for (var i = 0; i < fire.length; i++) {
            if(/^\d+$/.test(fire[i]))
            {
                var Time = fire[i];
                $(context).on('keyup', function(){
                    if(Timeout) clearTimeout(Timeout);
                    Timeout = setTimeout(send, Time);
                });
            }
            else
            {
                $(context).on(fire[i], send);
            }
        }

        function send()
        {
            var href = url.parse(location.href);
            var name = $(context).attr('name') || $(context).attr('data-name');
            if(href.get && href.get[name])
            {
                delete href.get[name];
            }
            var get = url.buildget(href.get);
            href = href.url.replace(/\?(.*)$/, get ? '?' + get : '');
            var action = $(context).attr('href') || $(context).attr('action') || $(context).attr('data-action') || href;
            var method = $(context).attr('data-method') || $(context).attr('method') || 'GET';
            var state = $(context).attr('data-state');
            var value = undefined;
            if($(context).is('form'))
            {
                var Data = new FormData(context);
                var data = {};
				if ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length)
                {
                    data = Data;
                }
                else
                {
                    Data.forEach(function (value, name) {
                        data[name] = /\[.*\]$/.test(name) ? Data.getAll(name) : Data.get(name);
                    });
                }
                state = false;
                $(context).addClass('lijax-sending');
                $('input, select, textarea, button', context).not(':disabled').addClass('lijax-disable').attr('disabled', 'disabled');
                $(context).on('statio:done', function () {
                    $('.lijax-disable', this).removeClass('lijax-disable').removeAttr('disabled')
                    $(this).removeClass('lijax-sending');
                });
            }
            else
            {
                value = $(context).val() || $(context).attr('data-value') || null;
                if($(context).is(':checkbox'))
                {
                    value = $(context).is(':checked') ? 1 : 0;
                }
                if(back_value == value && $(context).is('input, textarea, select') && !onFire) return;
                back_value = value;
                var data = {};
                data[name] = value;
            }
            if ($(context).attr('data-query'))
            {
                var action_query = url.parse(action);
                var data_query = url.parse('?' + $(context).attr('data-query'));
                action_query.get = $.extend(null, (action_query.get || {}), data_query.get);
                action = url.build(action_query);
            }
            var headers = {};
            if ($(context).attr('data-xhrBase'))
            {
                headers = {
                    'Data-xhr-base': $(context).attr('data-xhrBase')
                };
            }
            new Statio({
                type : state ? 'both' : 'render',
                context: context,
                ajax : {
					contentType: $(context).is('form') && ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length) ? false : 'application/x-www-form-urlencoded; charset=UTF-8',
					processData: ($(context).is('form') && ($(context).attr('enctype') == 'multipart/form-data' || $('input:file', context).length)) ? false : true,
                    cache       : false,
                    method : method,
                    data : data,
                    headers: headers
                },
                url : action
            });
            return false;
        }
        if (onFire)
        {
            send();
        }
    }
    window.Lijax = lijax;
})();
var media_xm = window.matchMedia("(max-width: 575.98px)");
var media_sm = window.matchMedia("(min-width: 576px) and (max-width: 767.98px)");
var media_md = window.matchMedia("(min-width: 768px) and (max-width: 991.98px)");
var media_lg = window.matchMedia("(min-width: 992px) and (max-width: 1199.98px)");
var media_xl = window.matchMedia("(min-width: 1200px)");


function event_media_xm(media){
	if(media.matches) return $(document).trigger('media:xm', [media]);
	else return $(document).trigger('media:xm:exit', [media]);
}
function event_media_sm(media){
	if(media.matches) return $(document).trigger('media:sm', [media]);
	else return $(document).trigger('media:sm:exit', [media]);
}
function event_media_md(media){
	if(media.matches) return $(document).trigger('media:md', [media]);
	else return $(document).trigger('media:md:exit', [media]);
}
function event_media_lg(media){
	if(media.matches) return $(document).trigger('media:lg', [media]);
	else return $(document).trigger('media:lg:exit', [media]);
}
function event_media_xl(media){
	if(media.matches) return $(document).trigger('media:xl', [media]);
	else return $(document).trigger('media:xl:exit', [media]);
}

$(document).ready(function(){
	event_media_xm(media_xm);
	media_xm.addListener(event_media_xm);

	event_media_sm(media_sm);
	media_sm.addListener(event_media_sm);

	event_media_md(media_md);
	media_md.addListener(event_media_md);

	event_media_lg(media_lg);
	media_lg.addListener(event_media_lg);

	event_media_xl(media_xl);
	media_xl.addListener(event_media_xl);
})

function responsive_menu() {
    $('#menu').removeClass('d-none').addClass('d-flex');
    // $('#desktop').removeClass('d-none');
    $('body').addClass('responsive-menu');
    $('#btn-menu').find($(".fas")).removeClass('fa-bars').addClass('fa-arrow-right');
    $(this).off('click.responsive-menu');
    $(this).on('click.close-responsive-menu', function() {
        $(this).off('click.close-responsive-menu');
        $(this).on('click.responsive-menu', responsive_menu);
        $('#menu').addClass('d-none').removeClass('d-flex');
        // $('#desktop').addClass('d-none');
        $('body').removeClass('responsive-menu');
        $('#btn-menu').find($(".fas")).removeClass('fa-arrow-right').addClass('fa-bars');
    });
}

$(document).on('media:xm media:sm', function(event, media) {
    $("body:not(.responsive-menu) #btn-menu").on('click.responsive-menu', responsive_menu);

    var menu = $('#menu');
    var desktop = $('#desktop');
    var btn_menu = $('#btn-menu');
    $(document).mouseup(function(e) {
        if (
            (!menu.is(e.target) && menu.has(e.target).length === 0)
            && (!desktop.is(e.target) && desktop.has(e.target).length === 0)
            && (!btn_menu.is(e.target) && btn_menu.has(e.target).length === 0)
            )
        {
            $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
        }
    });

    // $("body").swipe({
    //     swipe: function(event, direction, distance, duration, fingerCount, fingerData) {
    //         if (direction == 'left') {
    //             $("body:not(.responsive-menu) #btn-menu").trigger('click.responsive-menu');
    //         }

    //         if (direction == 'right') {
    //             $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    //         }

    //         if (direction == 'up' || direction == 'down') {
    //             if (!menu.is(event.target) && menu.has(event.target).length === 0) {
    //                 $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    //             }
    //         }
    //     }
    // });
});

$(document).on('media:md media:lg media:xl', function(event, media) {
    $("body.responsive-menu #btn-menu").trigger('click.close-responsive-menu');
    $("#btn-menu").off('click.responsive-menu');
    // $("#btn-menu").off('click.close-responsive-menu');
    // $('#menu').addClass('d-none').removeClass('d-flex');
    // $('#desktop').addClass('d-none');
    // $('body').removeClass('responsive-menu');
    // $('#btn-menu').find($(".fas")).removeClass('fa-arrow-right').addClass('fa-bars');
});
(function(){
	var _globals = {
		title : function (value){
			$('title').html(value);
		}
	}

	var _ajax = {
		type : 'GET',
		cache : false
	}

	var _options = {
		object : null,
		title : null,
		ajax : _ajax,
	/**
	 * Send request and change url with response rendering
	 * @default both
	 * both: change url and render response
	 * url: Only send request and chage url without change rendering
	 * render: Only send request and render repsonse without change url
	 * @type {String}
	 */
	 type : 'both',
	/**
	 * dont send any request
	 * @type {Boolean}
	 */
	 fake : false,
	/**
	 * ajax response contetnt
	 * if {fake:true} or {response : notnull} response render this property
	 * @type {[type]}
	 */
	 response : null,
	/**
	 * replace state
	 * @type {Boolean}
	 */
	 replace : false,
	/**
	 * event context
	 * @type {DOM} {jQuery} {Selector string}
	 */
	 context : document
	}

	function statio(custom){
		if(typeof custom != 'object')
		{
			custom = {};
		}

		custom.ajax = $.extend({}, _ajax, custom.ajax);
		custom.ajax.url = custom.url;
		custom.globals = $.extend({}, _globals, custom.globals);
		var options = $.extend({}, _options, custom);

		var response = {
			body : options.response,
			data : {},
		};

		if(!(options.context instanceof jQuery))
		{
			options.context = $(options.context);
		}

		$(document).trigger('statio:global:init', [options.context]);
		options.context.trigger('statio:init');


		var ajax_data = null;
		var ajax_send_url = null;
		if(!options.fake)
		{
			if(!options.ajax.complete)
			{
				options.ajax.complete = ajx_complete;
			}
			var beforeSend = options.ajax.beforeSend;
			options.ajax.beforeSend = function(jqXHR, settings)
			{
				ajax_data = this;
				ajax_send_url = this.url;
				var urlx = url.parse(ajax_send_url);
				if(urlx.get && urlx.get._)
				{
					delete urlx.get._;
				}
            	var get = url.buildget(urlx.get);
            	ajax_send_url = urlx.url.replace(/\?(.*)$/, get ? '?' + get : '');
				beforeSend ? beforeSend.call(this, jqXHR, settings) : null;
			}
			$.ajax(options.ajax);
		}
		else if(options.type != 'url' && response.body)
		{
			response_parse();
			render();
			$(document).trigger('statio:global:done', [options.context]);
			options.context.trigger('statio:done');
		}
		else
		{
			try {
				options.replace
					? history.replaceState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url)
					: history.pushState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url);
			}
			catch (e) {
				console.error(e);
			}
			$(document).trigger('statio:global:done', [options.context]);
			options.context.trigger('statio:done');
		}

		function ajx_complete(jqXHR, textStatus)
		{
			if(jqXHR.responseJSON)
			{
				response.data = jqXHR.responseJSON;
				$(document).trigger('statio:global:jsonResponse', [options.context, jqXHR.responseJSON, jqXHR]);
				options.context.trigger('statio:jsonResponse', [jqXHR.responseJSON, jqXHR]);
				new JResp(options.context, response.data);
			}
			else
			{
				response.body = jqXHR.responseText;
				response_parse();
				if(textStatus == 'success')
				{
					if (options.type != 'render') {
						try {
							options.response = response;
							options.replace
								? history.replaceState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url)
								: history.pushState(JSON.parse(JSON.stringify(options)), options.title, ajax_send_url || options.url);
						}
						catch (e) {
							try{
								options.replace
									? history.replaceState(options.data, options.title, ajax_send_url || options.url)
									: history.pushState(options.data, options.title, ajax_send_url || options.url);

							}
							catch (e){
								console.error(e);
							}
						}
					}
					$(document).trigger('statio:global:success', [options.context, response.data, response.body, jqXHR]);
					options.context.trigger('statio:success', [response.data, response.body, jqXHR]);
					if(options.type != 'url')
					{
						render();
					}
				}
				else
				{
					$(document).trigger('statio:global:errorResponse', [options.context, response.data, response.body, jqXHR]);
					options.context.trigger('statio:errorResponse', [response.data, response.body, jqXHR]);
				}
			}
			$(document).trigger('statio:global:done', [options.context, response.data, response.body, jqXHR]);
			options.context.trigger('statio:done', [response.data, response.body, jqXHR]);
		}

		function response_parse(){
			if(typeof response.body == 'string')
			{
				try
				{
					var split     = response.body.split("\n");
					response.data = JSON.parse(split[0]);
					response.body = split.length > 1 ? $($.parseHTML(split.splice(1).join(""))) : null;
				}catch(e){
					response.body  = $($.parseHTML(response.body));
				}
			}
			else if(typeof response.body == 'object' && response.body != null)
			{
				if(response.body instanceof HTMLElement)
				{
					response.body  = $(response.body);
				}
				else if(response.body instanceof jQuery)
				{

				}
				else
				{
					response.data = response.body;
					response.body = null;
				}
			}
		}

		function render(){
			for(D in response.data)
			{
				if(options.globals[D])
				{
					options.globals[D](response.data[D]);
				}
			}
			if(response.body)
			{
				var changed = [];
				response.body.each(function(){
					var base = $(this).attr('data-xhr');
					if(base)
					{
						changed.push($("[data-xhr='"+base+"']"));
						$("[data-xhr='"+base+"']").html($(this).html());
					}
				});
				$(document).trigger('statio:global:renderResponse', [$(changed), options.context, response.data, response.body]);
				options.context.trigger('statio:renderResponse', [$(changed), response.data, response.body]);
			}
		}
		return this;
	}
	window.Statio = statio;
	/**
	 * for new chrome bug
	 */
	 new Statio({
	 	url : location.href,
	 	fake : true,
	 	replace : true
	 });

	/**
	 * popstate event
	 */
	 window.onpopstate = function(event){
	 	new Statio({
	 		url : location.href,
	 		replace : true
	 	});
	 };
})();

// Copyright 2013-2014 Kevin Cox

/*******************************************************************************
*                                                                              *
*  This software is provided 'as-is', without any express or implied           *
*  warranty. In no event will the authors be held liable for any damages       *
*  arising from the use of this software.                                      *
*                                                                              *
*  Permission is granted to anyone to use this software for any purpose,       *
*  including commercial applications, and to alter it and redistribute it      *
*  freely, subject to the following restrictions:                              *
*                                                                              *
*  1. The origin of this software must not be misrepresented; you must not     *
*     claim that you wrote the original software. If you use this software in  *
*     a product, an acknowledgment in the product documentation would be       *
*     appreciated but is not required.                                         *
*                                                                              *
*  2. Altered source versions must be plainly marked as such, and must not be  *
*     misrepresented as being the original software.                           *
*                                                                              *
*  3. This notice may not be removed or altered from any source distribution.  *
*                                                                              *
*******************************************************************************/

+function(){
"use strict";

var array = /\[([^\[]*)\]$/;

/// URL Regex.
/**
 * This regex splits the URL into parts.  The capture groups catch the important
 * bits.
 *
 * Each section is optional, so to work on any part find the correct top level
 * `(...)?` and mess around with it.
 */
var regex = /^(?:([a-z]*):)?(?:\/\/)?(?:([^:@]*)(?::([^@]*))?@)?([0-9a-z-._]+)?(?::([0-9]*))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i;
//               1 - scheme              2 - user    3 = pass    4 - host           5 - port  6 - path        7 - query    8 - hash

var noslash = ["mailto","bitcoin"];

var self = {
	/** Parse a query string.
	 *
	 * This function parses a query string (sometimes called the search
	 * string).  It takes a query string and returns a map of the results.
	 *
	 * Keys are considered to be everything up to the first '=' and values are
	 * everything afterwords.  Since URL-decoding is done after parsing, keys
	 * and values can have any values, however, '=' have to be encoded in keys
	 * while '?' and '&' have to be encoded anywhere (as they delimit the
	 * kv-pairs).
	 *
	 * Keys and values will always be strings, except if there is a key with no
	 * '=' in which case it will be considered a flag and will be set to true.
	 * Later values will override earlier values.
	 *
	 * Array keys are also supported.  By default keys in the form of `name[i]`
	 * will be returned like that as strings.  However, if you set the `array`
	 * flag in the options object they will be parsed into arrays.  Note that
	 * although the object returned is an `Array` object all keys will be
	 * written to it.  This means that if you have a key such as `k[forEach]`
	 * it will overwrite the `forEach` function on that array.  Also note that
	 * string properties always take precedence over array properties,
	 * irrespective of where they are in the query string.
	 *
	 *   url.get("array[1]=test&array[foo]=bar",{array:true}).array[1]  === "test"
	 *   url.get("array[1]=test&array[foo]=bar",{array:true}).array.foo === "bar"
	 *   url.get("array=notanarray&array[0]=1",{array:true}).array      === "notanarray"
	 *
	 * If array parsing is enabled keys in the form of `name[]` will
	 * automatically be given the next available index.  Note that this can be
	 * overwritten with later values in the query string.  For this reason is
	 * is best not to mix the two formats, although it is safe (and often
	 * useful) to add an automatic index argument to the end of a query string.
	 *
	 *   url.get("a[]=0&a[]=1&a[0]=2", {array:true})  -> {a:["2","1"]};
	 *   url.get("a[0]=0&a[1]=1&a[]=2", {array:true}) -> {a:["0","1","2"]};
	 *
	 * @param{string} q The query string (the part after the '?').
	 * @param{{full:boolean,array:boolean}=} opt Options.
	 *
	 * - full: If set `q` will be treated as a full url and `q` will be built.
	 *   by calling #parse to retrieve the query portion.
	 * - array: If set keys in the form of `key[i]` will be treated
	 *   as arrays/maps.
	 *
	 * @return{!Object.<string, string|Array>} The parsed result.
	 */
	"get": function(q, opt){
		q = q || "";
		if ( typeof opt          == "undefined" ) opt = {};
		if ( typeof opt["full"]  == "undefined" ) opt["full"] = false;
		if ( typeof opt["array"] == "undefined" ) opt["array"] = false;

		if ( opt["full"] === true )
		{
			q = self["parse"](q, {"get":false})["query"] || "";
		}

		var o = {};

		var c = q.split("&");
		for (var i = 0; i < c.length; i++)
		{
			if (!c[i].length) continue;

			var d = c[i].indexOf("=");
			var k = c[i], v = true;
			if ( d >= 0 )
			{
				k = c[i].substr(0, d);
				v = c[i].substr(d+1);

				v = decodeURIComponent(v);
			}

			if (opt["array"])
			{
				var inds = [];
				var ind;
				var curo = o;
				var curk = k;
				while (ind = curk.match(array)) // Array!
				{
					curk = curk.substr(0, ind.index);
					inds.unshift(decodeURIComponent(ind[1]));
				}
				curk = decodeURIComponent(curk);
				if (inds.some(function(i)
				{
					if ( typeof curo[curk] == "undefined" ) curo[curk] = [];
					if (!Array.isArray(curo[curk]))
					{
						//console.log("url.get: Array property "+curk+" already exists as string!");
						return true;
					}

					curo = curo[curk];

					if ( i === "" ) i = curo.length;

					curk = i;
				})) continue;
				curo[curk] = v;
				continue;
			}

			k = decodeURIComponent(k);

			//typeof o[k] == "undefined" || console.log("Property "+k+" already exists!");
			o[k] = v;
		}

		return o;
	},

	/** Build a get query from an object.
	 *
	 * This constructs a query string from the kv pairs in `data`.  Calling
	 * #get on the string returned should return an object identical to the one
	 * passed in except all non-boolean scalar types become strings and all
	 * object types become arrays (non-integer keys are still present, see
	 * #get's documentation for more details).
	 *
	 * This always uses array syntax for describing arrays.  If you want to
	 * serialize them differently (like having the value be a JSON array and
	 * have a plain key) you will need to do that before passing it in.
	 *
	 * All keys and values are supported (binary data anyone?) as they are
	 * properly URL-encoded and #get properly decodes.
	 *
	 * @param{Object} data The kv pairs.
	 * @param{string} prefix The properly encoded array key to put the
	 *   properties.  Mainly intended for internal use.
	 * @return{string} A URL-safe string.
	 */
	"buildget": function(data, prefix){
		var itms = [];
		for ( var k in data )
		{
			var ek = encodeURIComponent(k);
			if ( typeof prefix != "undefined" )
				ek = prefix+"["+ek+"]";

			var v = data[k];

			switch (typeof v)
			{
				case 'boolean':
					if(v) itms.push(ek);
					break;
				case 'number':
					v = v.toString();
				case 'string':
					itms.push(ek+"="+encodeURIComponent(v));
					break;
				case 'object':
					itms.push(self["buildget"](v, ek));
					break;
			}
		}
		return itms.join("&");
	},

	/** Parse a URL
	 *
	 * This breaks up a URL into components.  It attempts to be very liberal
	 * and returns the best result in most cases.  This means that you can
	 * often pass in part of a URL and get correct categories back.  Notably,
	 * this works for emails and Jabber IDs, as well as adding a '?' to the
	 * beginning of a string will parse the whole thing as a query string.  If
	 * an item is not found the property will be undefined.  In some cases an
	 * empty string will be returned if the surrounding syntax but the actual
	 * value is empty (example: "://example.com" will give a empty string for
	 * scheme.)  Notably the host name will always be set to something.
	 *
	 * Returned properties.
	 *
	 * - **scheme:** The url scheme. (ex: "mailto" or "https")
	 * - **user:** The username.
	 * - **pass:** The password.
	 * - **host:** The hostname. (ex: "localhost", "123.456.7.8" or "example.com")
	 * - **port:** The port, as a number. (ex: 1337)
	 * - **path:** The path. (ex: "/" or "/about.html")
	 * - **query:** "The query string. (ex: "foo=bar&v=17&format=json")
	 * - **get:** The query string parsed with get.  If `opt.get` is `false` this
	 *   will be absent
	 * - **hash:** The value after the hash. (ex: "myanchor")
	 *   be undefined even if `query` is set.
	 *
	 * @param{string} url The URL to parse.
	 * @param{{get:Object}=} opt Options:
	 *
	 * - get: An options argument to be passed to #get or false to not call #get.
	 *    **DO NOT** set `full`.
	 *
	 * @return{!Object} An object with the parsed values.
	 */
	"parse": function(url, opt) {

		if ( typeof opt == "undefined" ) opt = {};

		var md = url.match(regex) || [];

		var r = {
			"url":    url,

			"scheme": md[1],
			"user":   md[2],
			"pass":   md[3],
			"host":   md[4],
			"port":   md[5] && +md[5],
			"path":   md[6],
			"query":  md[7],
			"hash":   md[8],
		};

		if ( opt.get !== false )
			r["get"] = r["query"] && self["get"](r["query"], opt.get);

		return r;
	},

	/** Build a URL from components.
	 *
	 * This pieces together a url from the properties of the passed in object.
	 * In general passing the result of `parse()` should return the URL.  There
	 * may differences in the get string as the keys and values might be more
	 * encoded then they were originally were.  However, calling `get()` on the
	 * two values should yield the same result.
	 *
	 * Here is how the parameters are used.
	 *
	 *  - url: Used only if no other values are provided.  If that is the case
	 *     `url` will be returned verbatim.
	 *  - scheme: Used if defined.
	 *  - user: Used if defined.
	 *  - pass: Used if defined.
	 *  - host: Used if defined.
	 *  - path: Used if defined.
	 *  - query: Used only if `get` is not provided and non-empty.
	 *  - get: Used if non-empty.  Passed to #buildget and the result is used
	 *    as the query string.
	 *  - hash: Used if defined.
	 *
	 * These are the options that are valid on the options object.
	 *
	 *  - useemptyget: If truthy, a question mark will be appended for empty get
	 *    strings.  This notably makes `build()` and `parse()` fully symmetric.
	 *
	 * @param{Object} data The pieces of the URL.
	 * @param{Object} opt Options for building the url.
	 * @return{string} The URL.
	 */
	"build": function(data, opt){
		opt = opt || {};

		var r = "";

		if ( typeof data["scheme"] != "undefined" )
		{
			r += data["scheme"];
			r += (noslash.indexOf(data["scheme"])>=0)?":":"://";
		}
		if ( typeof data["user"] != "undefined" )
		{
			r += data["user"];
			if ( typeof data["pass"] == "undefined" )
			{
				r += "@";
			}
		}
		if ( typeof data["pass"] != "undefined" ) r += ":" + data["pass"] + "@";
		if ( typeof data["host"] != "undefined" ) r += data["host"];
		if ( typeof data["port"] != "undefined" ) r += ":" + data["port"];
		if ( typeof data["path"] != "undefined" ) r += data["path"];

		if (opt["useemptyget"])
		{
			if      ( typeof data["get"]   != "undefined" ) r += "?" + self["buildget"](data["get"]);
			else if ( typeof data["query"] != "undefined" ) r += "?" + data["query"];
		}
		else
		{
			// If .get use it.  If .get leads to empty, use .query.
			var q = data["get"] && self["buildget"](data["get"]) || data["query"];
			if (q) r += "?" + q;
		}

		if ( typeof data["hash"] != "undefined" ) r += "#" + data["hash"];

		return r || data["url"] || "";
	},
};

if ( typeof define != "undefined" && define["amd"] ) define(self);
else if ( typeof module != "undefined" ) module['exports'] = self;
else window["url"] = self;

}();
(function () {
	function ViwFile()
	{
		$('.custom-file-input', this).on('change', function(){
			if (!window.File && !window.FileReader && !window.FileList && !window.Blob) {
				console.error('FileReader unsupported!');
				return false;
			}
			var file_index = 0;
			var file;
			$(this).next().html('');
			var files = [];
			while (file = this.files.item(file_index++))
			{
				files.push(file.name);
			}
			$(this).next().html(files.join(' : '));
		});
	}
	$(document).on('statio:global:renderResponse', function (event, base, contex) {
		base.each(function () {
			ViwFile.call(this);
		});
	});
	ViwFile.call(document);
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImRhdGVwaWNrZXIuanMiLCJKUmVzcC5qcyIsIkxpamF4LmpzIiwibWVkaWEtZXZlbnQuanMiLCJzaWRlYmFyLXJlc3BvbnNpdmUuanMiLCJTdGF0aW8uanMiLCJVcmwuanMiLCJ2aXdmaWxlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzYXJrb290Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGFzaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FzaWRlJyk7XHJcbmNvbnN0IGFzaWRlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FzaWRlLWJ0bicpO1xyXG5mdW5jdGlvbiBoYW5kbGVBc2lkZShldmVudCkge1xyXG4gICAgYXNpZGUuY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xyXG59XHJcbmFzaWRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQXNpZGUpO1xyXG5cclxuY29uc3QgcHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlJyk7XHJcbmNvbnN0IGRyb3Bkb3duID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGUtZHJvcGRvd24nKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVDbGljayhldmVudCkge1xyXG4gICAgZHJvcGRvd24uY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xyXG59XHJcblxyXG5wcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlUHJvZmlsZUNsaWNrKTtcclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIGlmICghZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5wcm9maWxlLWRpdicpKSB7XHJcbiAgICAgICAgZHJvcGRvd24uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xyXG4gICAgfVxyXG4gICAgaWYgKCFldmVudC50YXJnZXQuY2xvc2VzdCgnI2FzaWRlJykgJiYgIWV2ZW50LnRhcmdldC5jbG9zZXN0KCcjYXNpZGUtYnRuJykpIHtcclxuICAgICAgICBhc2lkZS5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuYW00Y29yZS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgLy8gVGhlbWVzIGJlZ2luXHJcbiAgICBhbTRjb3JlLnVzZVRoZW1lKGFtNHRoZW1lc19hbWNoYXJ0cyk7XHJcbiAgICAvLyBUaGVtZXMgZW5kXHJcblxyXG4gICAgLy8gQ3JlYXRlIGNoYXJ0IGluc3RhbmNlXHJcbiAgICB2YXIgY2hhcnQgPSBhbTRjb3JlLmNyZWF0ZShcImNoYXJ0ZGl2XCIsIGFtNGNoYXJ0cy5YWUNoYXJ0KTtcclxuXHJcbiAgICBjaGFydC5ydGwgPSB0cnVlO1xyXG5cclxuICAgIC8vIEFkZCBkYXRhXHJcbiAgICBjaGFydC5kYXRhID0gW3tcclxuICAgICAgICBcImNvdW50cnlcIjogXCJVU0FcIixcclxuICAgICAgICBcInZpc2l0c1wiOiAyMDI1XHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiQ2hpbmFcIixcclxuICAgICAgICBcInZpc2l0c1wiOiAxODgyXHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiSmFwYW5cIixcclxuICAgICAgICBcInZpc2l0c1wiOiAxODA5XHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiR2VybWFueVwiLFxyXG4gICAgICAgIFwidmlzaXRzXCI6IDEzMjJcclxuICAgIH0sIHtcclxuICAgICAgICBcImNvdW50cnlcIjogXCJVS1wiLFxyXG4gICAgICAgIFwidmlzaXRzXCI6IDExMjJcclxuICAgIH0sIHtcclxuICAgICAgICBcImNvdW50cnlcIjogXCJGcmFuY2VcIixcclxuICAgICAgICBcInZpc2l0c1wiOiAxMTE0XHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiSW5kaWFcIixcclxuICAgICAgICBcInZpc2l0c1wiOiA5ODRcclxuICAgIH0sIHtcclxuICAgICAgICBcImNvdW50cnlcIjogXCJTcGFpblwiLFxyXG4gICAgICAgIFwidmlzaXRzXCI6IDcxMVxyXG4gICAgfSwge1xyXG4gICAgICAgIFwiY291bnRyeVwiOiBcIk5ldGhlcmxhbmRzXCIsXHJcbiAgICAgICAgXCJ2aXNpdHNcIjogNjY1XHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiUnVzc2lhXCIsXHJcbiAgICAgICAgXCJ2aXNpdHNcIjogNTgwXHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJjb3VudHJ5XCI6IFwiU291dGggS29yZWFcIixcclxuICAgICAgICBcInZpc2l0c1wiOiA0NDNcclxuICAgIH0sIHtcclxuICAgICAgICBcImNvdW50cnlcIjogXCJDYW5hZGFcIixcclxuICAgICAgICBcInZpc2l0c1wiOiA0NDFcclxuICAgIH0sIHtcclxuICAgICAgICBcImNvdW50cnlcIjogXCJCcmF6aWxcIixcclxuICAgICAgICBcInZpc2l0c1wiOiAzOTVcclxuICAgIH1dO1xyXG5cclxuICAgIC8vIENyZWF0ZSBheGVzXHJcblxyXG4gICAgdmFyIGNhdGVnb3J5QXhpcyA9IGNoYXJ0LnhBeGVzLnB1c2gobmV3IGFtNGNoYXJ0cy5DYXRlZ29yeUF4aXMoKSk7XHJcbiAgICBjYXRlZ29yeUF4aXMuZGF0YUZpZWxkcy5jYXRlZ29yeSA9IFwiY291bnRyeVwiO1xyXG4gICAgY2F0ZWdvcnlBeGlzLnJlbmRlcmVyLmdyaWQudGVtcGxhdGUubG9jYXRpb24gPSAwO1xyXG4gICAgY2F0ZWdvcnlBeGlzLnJlbmRlcmVyLm1pbkdyaWREaXN0YW5jZSA9IDMwO1xyXG5cclxuICAgIGNhdGVnb3J5QXhpcy5yZW5kZXJlci5sYWJlbHMudGVtcGxhdGUuYWRhcHRlci5hZGQoXCJkeVwiLCBmdW5jdGlvbiAoZHksIHRhcmdldCkge1xyXG4gICAgICAgIGlmICh0YXJnZXQuZGF0YUl0ZW0gJiYgdGFyZ2V0LmRhdGFJdGVtLmluZGV4ICYgMiA9PSAyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkeSArIDI1O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZHk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB2YXIgdmFsdWVBeGlzID0gY2hhcnQueUF4ZXMucHVzaChuZXcgYW00Y2hhcnRzLlZhbHVlQXhpcygpKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgc2VyaWVzXHJcbiAgICB2YXIgc2VyaWVzID0gY2hhcnQuc2VyaWVzLnB1c2gobmV3IGFtNGNoYXJ0cy5Db2x1bW5TZXJpZXMoKSk7XHJcbiAgICBzZXJpZXMuZGF0YUZpZWxkcy52YWx1ZVkgPSBcInZpc2l0c1wiO1xyXG4gICAgc2VyaWVzLmRhdGFGaWVsZHMuY2F0ZWdvcnlYID0gXCJjb3VudHJ5XCI7XHJcbiAgICBzZXJpZXMubmFtZSA9IFwiVmlzaXRzXCI7XHJcbiAgICBzZXJpZXMuY29sdW1ucy50ZW1wbGF0ZS50b29sdGlwVGV4dCA9IFwie2NhdGVnb3J5WH06IFtib2xkXXt2YWx1ZVl9Wy9dXCI7XHJcbiAgICBzZXJpZXMuY29sdW1ucy50ZW1wbGF0ZS5maWxsT3BhY2l0eSA9IC44O1xyXG5cclxuICAgIHZhciBjb2x1bW5UZW1wbGF0ZSA9IHNlcmllcy5jb2x1bW5zLnRlbXBsYXRlO1xyXG4gICAgY29sdW1uVGVtcGxhdGUuc3Ryb2tlV2lkdGggPSAyO1xyXG4gICAgY29sdW1uVGVtcGxhdGUuc3Ryb2tlT3BhY2l0eSA9IDE7XHJcblxyXG59KTsgLy8gZW5kIGFtNGNvcmUucmVhZHkoKVxyXG5cclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XHJcbiAgICAkKCcuc2VsZWN0MicpLnNlbGVjdDIoKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiByZWFkVVJMKGlucHV0KSB7XHJcbiAgICBpZiAoaW5wdXQuZmlsZXMgJiYgaW5wdXQuZmlsZXNbMF0pIHtcclxuICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuXHJcbiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgJChpbnB1dCkubmV4dCgnbGFiZWwnKS5jaGlsZHJlbignaW1nJykuYXR0cignc3JjJywgZS50YXJnZXQucmVzdWx0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGlucHV0LmZpbGVzWzBdKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4kKCcuaW5wdXQtYXZhdGFyJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xyXG4gICAgcmVhZFVSTCh0aGlzKTtcclxufSk7IiwiXHJcbnZhciBkYXRlcGlja2VyID0gZnVuY3Rpb24gKGVsZW1lbnRJRCwgb3B0KSB7XHJcblxyXG4gICAgLy8gY2hlY2sgYXJndW1lbnRzXHJcbiAgICBpZiAodHlwZW9mIGVsZW1lbnRJRCAhPT0gXCJzdHJpbmdcIiB8fCBlbGVtZW50SUQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcImRhdGVwaWNrZXIgZXJyb3I6IGlucHV0IElEIGlzIG5vdCBzdHJpbmcgb3IgaXMgZW1wdHlcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIG9wdGlvbnMgPSBvcHQgfHwge307XHJcblxyXG4gICAgLy8gdmFyaWFibGVzXHJcbiAgICB2YXIgaXNDYWxDbGlja2VkID0gZmFsc2U7XHJcbiAgICB2YXIgaXNTeW5jZWQgPSBmYWxzZTtcclxuXHJcbiAgICB2YXIgZGF5T2ZXZWVrO1xyXG5cclxuICAgIHZhciBzZWxlY3RlZFllYXI7XHJcbiAgICB2YXIgc2VsZWN0ZWRNb250aDtcclxuICAgIHZhciBzZWxlY3RlZERheTtcclxuXHJcbiAgICB2YXIgY3VycmVudFllYXI7XHJcbiAgICB2YXIgY3VycmVudE1vbnRoO1xyXG4gICAgdmFyIGN1cnJlbnREYXk7XHJcblxyXG4gICAgdmFyIHRvZGF5c1llYXI7XHJcbiAgICB2YXIgdG9kYXlzTW9udGg7XHJcbiAgICB2YXIgdG9kYXlzRGF5O1xyXG5cclxuICAgIHZhciBkYXlPZldlZWtKO1xyXG5cclxuICAgIHZhciBudW1iZXJPZkRheXM7XHJcblxyXG4gICAgdmFyIHRvZGF5RztcclxuICAgIHZhciB0b2RheXNKO1xyXG5cclxuICAgIC8vIGNvbnN0c1xyXG4gICAgdmFyIE1PTlRIX05BTUVTID0ge1xyXG4gICAgICAgIFwiMVwiOiBcItmB2LHZiNix2K/bjNmGXCJcclxuICAgICAgICAsIFwiMlwiOiBcItin2LHYr9uM2KjZh9i02KpcIlxyXG4gICAgICAgICwgXCIzXCI6IFwi2K7Ysdiv2KfYr1wiXHJcbiAgICAgICAgLCBcIjRcIjogXCLYqtuM2LFcIlxyXG4gICAgICAgICwgXCI1XCI6IFwi2YXYsdiv2KfYr1wiXHJcbiAgICAgICAgLCBcIjZcIjogXCLYtNmH2LHbjNmI2LFcIlxyXG4gICAgICAgICwgXCI3XCI6IFwi2YXZh9ixXCJcclxuICAgICAgICAsIFwiOFwiOiBcItii2KjYp9mGXCJcclxuICAgICAgICAsIFwiOVwiOiBcItii2LDYsVwiXHJcbiAgICAgICAgLCBcIjEwXCI6IFwi2K/bjFwiXHJcbiAgICAgICAgLCBcIjExXCI6IFwi2KjZh9mF2YZcIlxyXG4gICAgICAgICwgXCIxMlwiOiBcItin2LPZgdmG2K9cIlxyXG4gICAgfVxyXG4gICAgdmFyIERBWV9OQU1FUyA9IHtcclxuICAgICAgICBcIti02YbYqNmHXCI6IFwi2LRcIlxyXG4gICAgICAgICwgXCLbjNqp2LTZhtio2YdcIjogXCLbjFwiXHJcbiAgICAgICAgLCBcItiv2YjYtNmG2KjZh1wiOiBcItivXCJcclxuICAgICAgICAsIFwi2LPZhyDYtNmG2KjZh1wiOiBcItizXCJcclxuICAgICAgICAsIFwi2obZh9in2LHYtNmG2KjZh1wiOiBcItqGXCJcclxuICAgICAgICAsIFwi2b7ZhtisINi02YbYqNmHXCI6IFwi2b5cIlxyXG4gICAgICAgICwgXCLYrNmF2LnZh1wiOiBcItisXCJcclxuICAgIH07XHJcbiAgICB2YXIgRkFfTlVNUyA9IFsn2aAnLCAn2aEnLCAn2aInLCAn2aMnLCAn27QnLCAn27UnLCAn27YnLCAn2acnLCAn2agnLCAn2aknLCAn2aHZoCcsICfZodmhJywgJ9mh2aInLCAn2aHZoycsICfZodu0JywgJ9mh27UnLCAn2aHbticsICfZodmnJywgJ9mh2agnLCAn2aHZqScsICfZotmgJywgJ9mi2aEnLCAn2aLZoicsICfZotmjJywgJ9mi27QnLCAn2aLbtScsICfZotu2JywgJ9mi2acnLCAn2aLZqCcsICfZotmpJywgJ9mj2aAnLCAn2aPZoScsICfZo9miJ107XHJcblxyXG4gICAgLy8gc2V0IG9wdGlvbnNcclxuICAgIG9wdGlvbnMucGxhY2Vob2xkZXIgPSBvcHRpb25zLnBsYWNlaG9sZGVyICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnBsYWNlaG9sZGVyIDogXCJcIjtcclxuICAgIG9wdGlvbnMudHdvZGlnaXQgPSBvcHRpb25zLnR3b2RpZ2l0ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnR3b2RpZ2l0IDogdHJ1ZTtcclxuICAgIG9wdGlvbnMuY2xvc2VBZnRlclNlbGVjdCA9IG9wdGlvbnMuY2xvc2VBZnRlclNlbGVjdCAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jbG9zZUFmdGVyU2VsZWN0IDogdHJ1ZTtcclxuICAgIG9wdGlvbnMubmV4dEJ1dHRvbkljb24gPSBvcHRpb25zLm5leHRCdXR0b25JY29uICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm5leHRCdXR0b25JY29uIDogZmFsc2U7XHJcbiAgICBvcHRpb25zLnByZXZpb3VzQnV0dG9uSWNvbiA9IG9wdGlvbnMucHJldmlvdXNCdXR0b25JY29uICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnByZXZpb3VzQnV0dG9uSWNvbiA6IGZhbHNlO1xyXG4gICAgb3B0aW9ucy5idXR0b25zQ29sb3IgPSBvcHRpb25zLmJ1dHRvbnNDb2xvciAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5idXR0b25zQ29sb3IgOiBmYWxzZTtcclxuICAgIG9wdGlvbnMuZm9yY2VGYXJzaURpZ2l0cyA9IG9wdGlvbnMuZm9yY2VGYXJzaURpZ2l0cyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5mb3JjZUZhcnNpRGlnaXRzIDogZmFsc2U7XHJcbiAgICBvcHRpb25zLm1hcmtUb2RheSA9IG9wdGlvbnMubWFya1RvZGF5ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm1hcmtUb2RheSA6IGZhbHNlO1xyXG4gICAgb3B0aW9ucy5tYXJrSG9saWRheXMgPSBvcHRpb25zLm1hcmtIb2xpZGF5cyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5tYXJrSG9saWRheXMgOiBmYWxzZTtcclxuICAgIG9wdGlvbnMuaGlnaGxpZ2h0U2VsZWN0ZWREYXkgPSBvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5ICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5IDogZmFsc2U7XHJcbiAgICBvcHRpb25zLnN5bmMgPSBvcHRpb25zLnN5bmMgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuc3luYyA6IGZhbHNlO1xyXG4gICAgb3B0aW9ucy5nb3RvVG9kYXkgPSBvcHRpb25zLmdvdG9Ub2RheSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5nb3RvVG9kYXkgOiBmYWxzZTtcclxuXHJcbiAgICAvLyBjcmVhdGUgRE9NXHJcbiAgICB2YXIgaW5wdXRFbGVtZW50ID0gJChcIiNcIiArIGVsZW1lbnRJRCk7XHJcblxyXG4gICAgaWYgKGlucHV0RWxlbWVudC5hdHRyKFwicGxhY2Vob2xkZXJcIikgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5hdHRyKFwicGxhY2Vob2xkZXJcIiwgb3B0aW9ucy5wbGFjZWhvbGRlcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY3JlYXRlIHBhcmVudCBkaXZcclxuICAgIGlucHV0RWxlbWVudC53cmFwKFwiPGRpdiBpZD0nYmQtcm9vdC1cIiArIGVsZW1lbnRJRCArIFwiJyBzdHlsZT0ncG9zaXRpb246IHJlbGF0aXZlOyc+PC9kaXY+XCIpO1xyXG5cclxuICAgIC8vIGNyZWF0ZSBtYWluIGRpdiBmb3IgY2FsZW5kYXIsIGJlbG93IGlucHV0IGVsZW1lbnRcclxuICAgIGlucHV0RWxlbWVudC5hZnRlcihcIjxkaXYgaWQ9J2JkLW1haW4tXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLW1haW4gYmQtaGlkZScgc3R5bGU9J3Bvc2l0aW9uOiBhYnNvbHV0ZTsgZGlyZWN0aW9uOiBydGw7Jz48L2Rpdj5cIik7XHJcbiAgICB2YXIgbWFpbkRpdiA9ICQoXCIjYmQtbWFpbi1cIiArIGVsZW1lbnRJRCk7XHJcblxyXG4gICAgLy8gY3JlYXRlIGNhbGVuZGFyIGRpdiBpbnNpZGUgbWFpbiBkaXZcclxuICAgIG1haW5EaXYuYXBwZW5kKFwiPGRpdiBjbGFzcz0nYmQtY2FsZW5kYXInPjwvZGl2PlwiKTtcclxuICAgIHZhciBjYWxlbmRhckRpdiA9IG1haW5EaXYuZmluZCgnLmJkLWNhbGVuZGFyJyk7XHJcblxyXG4gICAgLy8gY3JlYXRlIHRpdGxlIGRpdiBhbmQgdGFibGUgaW5zaWRlIGNhbGVuZGFyIGRpdlxyXG4gICAgY2FsZW5kYXJEaXYuYXBwZW5kKFwiPGRpdiBjbGFzcz0nYmQtdGl0bGUnPjwvZGl2PlwiKTtcclxuICAgIHZhciB0aXRsZURpdiA9IGNhbGVuZGFyRGl2LmZpbmQoJy5iZC10aXRsZScpO1xyXG4gICAgY2FsZW5kYXJEaXYuYXBwZW5kKFwiPHRhYmxlIGNsYXNzPSdiZC10YWJsZScgZGlyPSdydGwnIGNlbGxzcGFjaW5nPScwJyBjZWxscGFkZGluZz0nMCc+PC90YWJsZT5cIik7XHJcblxyXG4gICAgLy8gY3JlYXRlIG1vbnRoIGFuZCB5ZWFyIGRyb3AgZG93bnMgYW5kIG5leHQvcHJldiBtb250aCBidXR0b25zIGluc2lkZSB0aXRsZSBkaXZcclxuICAgIHRpdGxlRGl2LmFwcGVuZChcIjxidXR0b24gaWQ9J2JkLW5leHQtXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLW5leHQnIHR5cGU9J2J1dHRvbicgdGl0bGU9J9mF2KfZhyDYqNi52K/bjCcgZGF0YS10b2dnbGU9J3Rvb2x0aXAnPjxzcGFuPtio2LnYr9uMPC9zcGFuPjwvYnV0dG9uPlwiKTtcclxuICAgIHZhciBuZXh0TW9udGggPSAkKFwiI2JkLW5leHQtXCIgKyBlbGVtZW50SUQpO1xyXG4gICAgaWYgKG9wdGlvbnMubmV4dEJ1dHRvbkljb24pIHtcclxuICAgICAgICBuZXh0TW9udGguZmluZChcInNwYW5cIikuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMubmV4dEJ1dHRvbkljb24uaW5kZXhPZihcIi5cIikgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIC8vIGltYWdlXHJcbiAgICAgICAgICAgIG5leHRNb250aC5jc3MoXCJiYWNrZ3JvdW5kLWltYWdlXCIsIFwidXJsKFwiICsgb3B0aW9ucy5uZXh0QnV0dG9uSWNvbiArIFwiKVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBjc3MgY2xhc3NcclxuICAgICAgICAgICAgbmV4dE1vbnRoLmFkZENsYXNzKG9wdGlvbnMubmV4dEJ1dHRvbkljb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aXRsZURpdi5hcHBlbmQoXCI8ZGl2IGNsYXNzPSdiZC1kcm9wZG93bic+PC9kaXY+PGRpdiBjbGFzcz0nYmQtZHJvcGRvd24nPjwvZGl2PlwiKTtcclxuXHJcbiAgICB0aXRsZURpdi5maW5kKCcuYmQtZHJvcGRvd246bnRoLWNoaWxkKDIpJykuYXBwZW5kKFwiPHNlbGVjdCBpZD0nYmQtbW9udGgtXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLW1vbnRoJz48L3NlbGVjdD5cIik7XHJcbiAgICB2YXIgbW9udGhEcm9wZG93biA9ICQoXCIjYmQtbW9udGgtXCIgKyBlbGVtZW50SUQpO1xyXG4gICAgJC5lYWNoKE1PTlRIX05BTUVTLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIG1vbnRoRHJvcGRvd24uYXBwZW5kKCQoXCI8b3B0aW9uPjwvb3B0aW9uPlwiKS5hdHRyKFwidmFsdWVcIiwga2V5KS50ZXh0KHZhbHVlKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aXRsZURpdi5maW5kKCcuYmQtZHJvcGRvd246bnRoLWNoaWxkKDMpJykuYXBwZW5kKFwiPHNlbGVjdCBpZD0nYmQteWVhci1cIiArIGVsZW1lbnRJRCArIFwiJyBjbGFzcz0nYmQteWVhcic+PC9zZWxlY3Q+XCIpO1xyXG4gICAgdmFyIHllYXJEcm9wZG93biA9ICQoXCIjYmQteWVhci1cIiArIGVsZW1lbnRJRCk7XHJcblxyXG4gICAgdGl0bGVEaXYuYXBwZW5kKFwiPGJ1dHRvbiBpZD0nYmQtcHJldi1cIiArIGVsZW1lbnRJRCArIFwiJyBjbGFzcz0nYmQtcHJldicgdHlwZT0nYnV0dG9uJyB0aXRsZT0n2YXYp9mHINmC2KjZhNuMJyBkYXRhLXRvZ2dsZT0ndG9vbHRpcCc+PHNwYW4+2YLYqNmE24w8L3NwYW4+PC9idXR0b24+XCIpO1xyXG4gICAgdmFyIHByZXZNb250aCA9ICQoXCIjYmQtcHJldi1cIiArIGVsZW1lbnRJRCk7XHJcbiAgICBpZiAob3B0aW9ucy5uZXh0QnV0dG9uSWNvbikge1xyXG4gICAgICAgIHByZXZNb250aC5maW5kKFwic3BhblwiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuICAgICAgICBpZiAob3B0aW9ucy5wcmV2aW91c0J1dHRvbkljb24uaW5kZXhPZihcIi5cIikgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIC8vIGltYWdlXHJcbiAgICAgICAgICAgIHByZXZNb250aC5jc3MoXCJiYWNrZ3JvdW5kLWltYWdlXCIsIFwidXJsKFwiICsgb3B0aW9ucy5wcmV2aW91c0J1dHRvbkljb24gKyBcIilcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gY3NzIGNsYXNzXHJcbiAgICAgICAgICAgIHByZXZNb250aC5hZGRDbGFzcyhvcHRpb25zLnByZXZpb3VzQnV0dG9uSWNvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChvcHRpb25zLmJ1dHRvbnNDb2xvcikge1xyXG4gICAgICAgIG5leHRNb250aC5jc3MoXCJjb2xvclwiLCBvcHRpb25zLmJ1dHRvbnNDb2xvcik7XHJcbiAgICAgICAgbmV4dE1vbnRoLmZpbmQoXCJzcGFuXCIpLmNzcyhcImNvbG9yXCIsIG9wdGlvbnMuYnV0dG9uc0NvbG9yKTtcclxuICAgICAgICBwcmV2TW9udGguY3NzKFwiY29sb3JcIiwgb3B0aW9ucy5idXR0b25zQ29sb3IpO1xyXG4gICAgICAgIHByZXZNb250aC5maW5kKFwic3BhblwiKS5jc3MoXCJjb2xvclwiLCBvcHRpb25zLmJ1dHRvbnNDb2xvcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY3JlYXRlIHRhYmxlIGhlYWRlciBhbmQgYm9keVxyXG4gICAgY2FsZW5kYXJEaXYuZmluZCgnLmJkLXRhYmxlJykuYXBwZW5kKFwiPHRoZWFkPjx0cj48L3RyPjwvdGhlYWQ+XCIpO1xyXG4gICAgJC5lYWNoKERBWV9OQU1FUywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICBjYWxlbmRhckRpdi5maW5kKCcuYmQtdGFibGUgdGhlYWQgdHInKS5hcHBlbmQoJChcIjx0aD48L3RoPlwiKS50ZXh0KHZhbHVlKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYWxlbmRhckRpdi5maW5kKCcuYmQtdGFibGUnKS5hcHBlbmQoXCI8dGJvZHkgaWQ9J2JkLXRhYmxlLWRheXMtXCIgKyBlbGVtZW50SUQgKyBcIicgY2xhc3M9J2JkLXRhYmxlLWRheXMnPjwvdGJvZHk+XCIpO1xyXG4gICAgdmFyIGRheXNUYWJsZSA9ICQoXCIjYmQtdGFibGUtZGF5cy1cIiArIGVsZW1lbnRJRCk7XHJcblxyXG4gICAgLy8gY3JlYXRlIGdvIHRvIHRvZGF5cyBidXR0b25cclxuICAgIGlmIChvcHRpb25zLmdvdG9Ub2RheSkge1xyXG4gICAgICAgIGNhbGVuZGFyRGl2LmFwcGVuZChcIjxkaXYgY2xhc3M9J2JkLWdvdG8tdG9kYXknPtio2LHZiCDYqNmHINin2YXYsdmI2LI8L2Rpdj5cIik7XHJcbiAgICAgICAgdmFyIGdvdG9Ub2RheSA9IGNhbGVuZGFyRGl2LmZpbmQoXCIuYmQtZ290by10b2RheVwiKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBvcGVuaW5nIGFuZCBjbG9zaW5nIGZ1bmN0aW9uYWxpdHlcclxuICAgIGlucHV0RWxlbWVudC5vbihcImZvY3VzXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBtYWluRGl2LnJlbW92ZUNsYXNzKFwiYmQtaGlkZVwiKTtcclxuICAgICAgICBpZiAob3B0aW9ucy5zeW5jICYmIGlzU3luY2VkID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBzeW5jQ2FsZW5kYXIoKTtcclxuICAgICAgICAgICAgaXNTeW5jZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBtYWluRGl2O1xyXG4gICAgfSkub24oJ2JsdXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGlzQ2FsQ2xpY2tlZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBtYWluRGl2LmFkZENsYXNzKFwiYmQtaGlkZVwiKTtcclxuICAgICAgICAgICAgaXNTeW5jZWQgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpc0NhbENsaWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgaW5wdXRFbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgbWFpbkRpdi5vbignbW91c2Vkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgaXNDYWxDbGlja2VkID0gdHJ1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGRyb3Bkb3duIGV2ZW50c1xyXG4gICAgbW9udGhEcm9wZG93bi5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGVjdGVkTW9udGggPSBwYXJzZUludCh0aGlzLnZhbHVlKTtcclxuICAgICAgICBudW1iZXJPZkRheXMgPSBtb250aERheXMoc2VsZWN0ZWRZZWFyLCBzZWxlY3RlZE1vbnRoKTtcclxuICAgICAgICBkYXlPZldlZWtKID0gZmluZEZpcnN0RGF5T2ZNb250aChzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xyXG4gICAgICAgIGRyYXdEYXlzKG51bWJlck9mRGF5cywgZGF5T2ZXZWVrSik7XHJcbiAgICB9KTtcclxuICAgIHllYXJEcm9wZG93bi5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGVjdGVkWWVhciA9IHBhcnNlSW50KHRoaXMudmFsdWUpO1xyXG4gICAgICAgIG51bWJlck9mRGF5cyA9IG1vbnRoRGF5cyhzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpO1xyXG4gICAgICAgIGRheU9mV2Vla0ogPSBmaW5kRmlyc3REYXlPZk1vbnRoKHNlbGVjdGVkWWVhciwgc2VsZWN0ZWRNb250aCk7XHJcbiAgICAgICAgZHJhd0RheXMobnVtYmVyT2ZEYXlzLCBkYXlPZldlZWtKKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEdlb3JnaWFuIHRvIEphbGFsaSBjb252ZXJ0ZXIgKG1pbmlmaWVkKVxyXG4gICAgLy8gc291cmNlIGlzIHVua25vd24uIGNvbnRhY3QgaWYgeW91IGtub3cgdGhlIGNvZGUgb3duZXIuXHJcbiAgICBmdW5jdGlvbiBncmVnb3JpYW5Ub0phbGFsaShhLCByLCBzKSB7IGEgPSBwYXJzZUludChhKSwgciA9IHBhcnNlSW50KHIpLCBzID0gcGFyc2VJbnQocyk7IGZvciAodmFyIG4gPSBhIC0gMTYwMCwgZSA9IHIgLSAxLCB0ID0gcyAtIDEsIHAgPSAzNjUgKiBuICsgcGFyc2VJbnQoKG4gKyAzKSAvIDQpIC0gcGFyc2VJbnQoKG4gKyA5OSkgLyAxMDApICsgcGFyc2VJbnQoKG4gKyAzOTkpIC8gNDAwKSwgSSA9IDA7IGUgPiBJOyArK0kpIHAgKz0gZ19kYXlzW0ldOyBlID4gMSAmJiAobiAlIDQgPT0gMCAmJiBuICUgMTAwICE9IDAgfHwgbiAlIDQwMCA9PSAwKSAmJiArK3AsIHAgKz0gdDsgdmFyIHYgPSBwIC0gNzksIGQgPSBwYXJzZUludCh2IC8gMTIwNTMpOyB2ICU9IDEyMDUzOyB2YXIgbyA9IDk3OSArIDMzICogZCArIDQgKiBwYXJzZUludCh2IC8gMTQ2MSk7IHYgJT0gMTQ2MSwgdiA+PSAzNjYgJiYgKG8gKz0gcGFyc2VJbnQoKHYgLSAxKSAvIDM2NSksIHYgPSAodiAtIDEpICUgMzY1KTsgZm9yICh2YXIgSSA9IDA7IDExID4gSSAmJiB2ID49IGpfZGF5c1tJXTsgKytJKSB2IC09IGpfZGF5c1tJXTsgdmFyIHkgPSBJICsgMSwgXyA9IHYgKyAxOyByZXR1cm4gW28sIHksIF9dIH0gdmFyIGdfZGF5cyA9IFszMSwgMjgsIDMxLCAzMCwgMzEsIDMwLCAzMSwgMzEsIDMwLCAzMSwgMzAsIDMxXSwgal9kYXlzID0gWzMxLCAzMSwgMzEsIDMxLCAzMSwgMzEsIDMwLCAzMCwgMzAsIDMwLCAzMCwgMjldO1xyXG4gICAgLy8gSmFsYWxpIHRvIEdlb3JnaWFuIGNvbnZlcnRlciAobWluaWZpZWQpXHJcbiAgICAvLyBzb3VyY2UgaXMgdW5rbm93bi4gY29udGFjdCBpZiB5b3Uga25vdyB0aGUgY29kZSBvd25lci5cclxuICAgIGZ1bmN0aW9uIHRvSmFsYWFsaShkLCBpLCBhKSB7IHJldHVybiBkMmooZzJkKGQsIGksIGEpKSB9IGZ1bmN0aW9uIHRvR3JlZ29yaWFuKGQsIGksIGEpIHsgcmV0dXJuIGQyZyhqMmQoZCwgaSwgYSkpIH0gZnVuY3Rpb24gaXNWYWxpZEphbGFhbGlEYXRlKGQsIGksIGEpIHsgcmV0dXJuIGQgPj0gLTYxICYmIDMxNzcgPj0gZCAmJiBpID49IDEgJiYgMTIgPj0gaSAmJiBhID49IDEgJiYgYSA8PSBqYWxhYWxpTW9udGhMZW5ndGgoZCwgaSkgfSBmdW5jdGlvbiBpc0xlYXBKYWxhYWxpWWVhcihkKSB7IHJldHVybiAwID09PSBqYWxDYWwoZCkubGVhcCB9IGZ1bmN0aW9uIGphbGFhbGlNb250aExlbmd0aChkLCBpKSB7IHJldHVybiA2ID49IGkgPyAzMSA6IDExID49IGkgPyAzMCA6IGlzTGVhcEphbGFhbGlZZWFyKGQpID8gMzAgOiAyOSB9IGZ1bmN0aW9uIGphbENhbChkKSB7IHZhciBpLCBhLCBuLCByLCB0LCBvLCB2LCBlID0gWy02MSwgOSwgMzgsIDE5OSwgNDI2LCA2ODYsIDc1NiwgODE4LCAxMTExLCAxMTgxLCAxMjEwLCAxNjM1LCAyMDYwLCAyMDk3LCAyMTkyLCAyMjYyLCAyMzI0LCAyMzk0LCAyNDU2LCAzMTc4XSwgbCA9IGUubGVuZ3RoLCB1ID0gZCArIDYyMSwgbSA9IC0xNCwgZyA9IGVbMF07IGlmIChnID4gZCB8fCBkID49IGVbbCAtIDFdKSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIEphbGFhbGkgeWVhciBcIiArIGQpOyBmb3IgKHYgPSAxOyBsID4gdiAmJiAoaSA9IGVbdl0sIGEgPSBpIC0gZywgIShpID4gZCkpOyB2ICs9IDEpIG0gPSBtICsgOCAqIGRpdihhLCAzMykgKyBkaXYobW9kKGEsIDMzKSwgNCksIGcgPSBpOyByZXR1cm4gbyA9IGQgLSBnLCBtID0gbSArIDggKiBkaXYobywgMzMpICsgZGl2KG1vZChvLCAzMykgKyAzLCA0KSwgNCA9PT0gbW9kKGEsIDMzKSAmJiBhIC0gbyA9PT0gNCAmJiAobSArPSAxKSwgciA9IGRpdih1LCA0KSAtIGRpdigzICogKGRpdih1LCAxMDApICsgMSksIDQpIC0gMTUwLCB0ID0gMjAgKyBtIC0gciwgNiA+IGEgLSBvICYmIChvID0gbyAtIGEgKyAzMyAqIGRpdihhICsgNCwgMzMpKSwgbiA9IG1vZChtb2QobyArIDEsIDMzKSAtIDEsIDQpLCAtMSA9PT0gbiAmJiAobiA9IDQpLCB7IGxlYXA6IG4sIGd5OiB1LCBtYXJjaDogdCB9IH0gZnVuY3Rpb24gajJkKGQsIGksIGEpIHsgdmFyIG4gPSBqYWxDYWwoZCk7IHJldHVybiBnMmQobi5neSwgMywgbi5tYXJjaCkgKyAzMSAqIChpIC0gMSkgLSBkaXYoaSwgNykgKiAoaSAtIDcpICsgYSAtIDEgfSBmdW5jdGlvbiBkMmooZCkgeyB2YXIgaSwgYSwgbiwgciA9IGQyZyhkKS5neSwgdCA9IHIgLSA2MjEsIG8gPSBqYWxDYWwodCksIHYgPSBnMmQociwgMywgby5tYXJjaCk7IGlmIChuID0gZCAtIHYsIG4gPj0gMCkgeyBpZiAoMTg1ID49IG4pIHJldHVybiBhID0gMSArIGRpdihuLCAzMSksIGkgPSBtb2QobiwgMzEpICsgMSwgeyBqeTogdCwgam06IGEsIGpkOiBpIH07IG4gLT0gMTg2IH0gZWxzZSB0IC09IDEsIG4gKz0gMTc5LCAxID09PSBvLmxlYXAgJiYgKG4gKz0gMSk7IHJldHVybiBhID0gNyArIGRpdihuLCAzMCksIGkgPSBtb2QobiwgMzApICsgMSwgeyBqeTogdCwgam06IGEsIGpkOiBpIH0gfSBmdW5jdGlvbiBnMmQoZCwgaSwgYSkgeyB2YXIgbiA9IGRpdigxNDYxICogKGQgKyBkaXYoaSAtIDgsIDYpICsgMTAwMTAwKSwgNCkgKyBkaXYoMTUzICogbW9kKGkgKyA5LCAxMikgKyAyLCA1KSArIGEgLSAzNDg0MDQwODsgcmV0dXJuIG4gPSBuIC0gZGl2KDMgKiBkaXYoZCArIDEwMDEwMCArIGRpdihpIC0gOCwgNiksIDEwMCksIDQpICsgNzUyIH0gZnVuY3Rpb24gZDJnKGQpIHsgdmFyIGksIGEsIG4sIHIsIHQ7IHJldHVybiBpID0gNCAqIGQgKyAxMzkzNjE2MzEsIGkgPSBpICsgNCAqIGRpdigzICogZGl2KDQgKiBkICsgMTgzMTg3NzIwLCAxNDYwOTcpLCA0KSAtIDM5MDgsIGEgPSA1ICogZGl2KG1vZChpLCAxNDYxKSwgNCkgKyAzMDgsIG4gPSBkaXYobW9kKGEsIDE1MyksIDUpICsgMSwgciA9IG1vZChkaXYoYSwgMTUzKSwgMTIpICsgMSwgdCA9IGRpdihpLCAxNDYxKSAtIDEwMDEwMCArIGRpdig4IC0gciwgNiksIHsgZ3k6IHQsIGdtOiByLCBnZDogbiB9IH0gZnVuY3Rpb24gZGl2KGQsIGkpIHsgcmV0dXJuIH5+KGQgLyBpKSB9IGZ1bmN0aW9uIG1vZChkLCBpKSB7IHJldHVybiBkIC0gfn4oZCAvIGkpICogaSB9XHJcblxyXG4gICAgdmFyIHN5bmNDYWxlbmRhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaW5wdXRWYWx1ZSA9IGZpeERhdGUoaW5wdXRFbGVtZW50LnZhbCgpKTtcclxuICAgICAgICBpZiAoaW5wdXRWYWx1ZSA9PT0gXCJcIilcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICBpbnB1dFZhbHVlID0gaW5wdXRWYWx1ZS5zcGxpdChcIi9cIik7XHJcbiAgICAgICAgbW9udGhEcm9wZG93bi52YWwocGFyc2VJbnQoaW5wdXRWYWx1ZVsxXSkpO1xyXG4gICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcclxuICAgICAgICB5ZWFyRHJvcGRvd24udmFsKHBhcnNlSW50KGlucHV0VmFsdWVbMF0pKTtcclxuICAgICAgICB5ZWFyRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuaGlnaGxpZ2h0U2VsZWN0ZWREYXkpIHtcclxuICAgICAgICAgICAgbWFpbkRpdi5maW5kKFwiLmJkLXNlbGVjdGVkLWRheVwiKS5yZW1vdmVDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcclxuICAgICAgICAgICAgbWFpbkRpdi5maW5kKFwiLmRheS1cIiArIHBhcnNlSW50KGlucHV0VmFsdWVbMl0pKS5hZGRDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGZpeERhdGUgPSBmdW5jdGlvbiAoZGF0ZSkge1xyXG4gICAgICAgIGlmIChkYXRlID09PSBcIlwiKVxyXG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuXHJcbiAgICAgICAgZGF0ZSA9IGRhdGUuc3BsaXQoXCIvXCIpO1xyXG4gICAgICAgIC8vIGlmIChkYXRlWzBdLmxlbmd0aCA9PT0gMikge1xyXG4gICAgICAgIC8vICAgICBkYXRlWzBdID0gXCIxM1wiICsgZGF0ZVswXTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgaWYgKGRhdGVbMV0ubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICBpZiAoZGF0ZVsxXSA8IDEwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRlWzFdID0gXCIwXCIgKyBkYXRlWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRlWzJdLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGVbMl0gPCAxMCkge1xyXG4gICAgICAgICAgICAgICAgZGF0ZVsyXSA9IFwiMFwiICsgZGF0ZVsyXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBkYXRlID0gZGF0ZS5qb2luKFwiL1wiKTtcclxuICAgICAgICByZXR1cm4gZGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgY29udmVydFRvSldlZWsgPSBmdW5jdGlvbiAoZGF5T2ZXZWVrRykge1xyXG4gICAgICAgIHZhciBkYXlPZldlZWtKO1xyXG4gICAgICAgIGlmIChkYXlPZldlZWtHIDwgNikge1xyXG4gICAgICAgICAgICBkYXlPZldlZWtKID0gZGF5T2ZXZWVrRyArIDE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGF5T2ZXZWVrSiA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXlPZldlZWtKO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBtYWtlWWVhckxpc3QgPSBmdW5jdGlvbiAodGhpc1llYXIpIHtcclxuICAgICAgICB5ZWFyRHJvcGRvd24uZmluZCgnb3B0aW9uJykucmVtb3ZlKCk7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDEwMTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wWWVhciA9ICgodGhpc1llYXIgLSA5NSkgKyBpKSArICcnO1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5mb3JjZUZhcnNpRGlnaXRzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDEwOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmd4ID0gbmV3IFJlZ0V4cChqLCAnZycpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBZZWFyID0gdGVtcFllYXIucmVwbGFjZShyZ3gsIEZBX05VTVNbal0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi5hcHBlbmQoJCgnPG9wdGlvbj4nLCB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogKHRoaXNZZWFyIC0gOTUpICsgaSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IHRlbXBZZWFyXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gaXNsZWFwIGNhbGN1bGF0b3IsIHN1cHBvcnRlZCB5ZWFyOiAxMjQzIC0gMTQ3M1xyXG4gICAgdmFyIGlzTGVhcFllYXIgPSBmdW5jdGlvbiAoeWVhcikge1xyXG4gICAgICAgIHZhciBtb2Q7XHJcbiAgICAgICAgaWYgKHllYXIgPCAxMzQzICYmIHllYXIgPiAxMjQzKSB7XHJcbiAgICAgICAgICAgIG1vZCA9IHllYXIgJSAzMztcclxuICAgICAgICAgICAgaWYgKG1vZCA9PSAxIHx8IG1vZCA9PSA1IHx8IG1vZCA9PSA5IHx8IG1vZCA9PSAxMyB8fCBtb2QgPT0gMTcgfHwgbW9kID09IDIyIHx8IG1vZCA9PSAyNiB8fCBtb2QgPT0gMzApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh5ZWFyIDwgMTQ3MyAmJiB5ZWFyID4gMTM0Mikge1xyXG4gICAgICAgICAgICBtb2QgPSB5ZWFyICUgMTc7XHJcbiAgICAgICAgICAgIGlmIChtb2QgPT0gMSB8fCBtb2QgPT0gNSB8fCBtb2QgPT0gOSB8fCBtb2QgPT0gMTMgfHwgbW9kID09IDE4IHx8IG1vZCA9PSAyMiB8fCBtb2QgPT0gMjYgfHwgbW9kID09IDMwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwidW5rbm93blwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgbW9udGhEYXlzID0gZnVuY3Rpb24gKHllYXIsIG1vbnRoKSB7XHJcbiAgICAgICAgaWYgKG1vbnRoIDwgNykge1xyXG4gICAgICAgICAgICByZXR1cm4gMzE7XHJcbiAgICAgICAgfSBlbHNlIGlmIChtb250aCA8IDEyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAzMDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoaXNMZWFwWWVhcih5ZWFyKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDMwO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIG1ha2UgZmlyc3QgcGFnZSBvZiBjYWxlbmRhclxyXG4gICAgdG9kYXlHID0gbmV3IERhdGUoKTtcclxuXHJcbiAgICB0b2RheXNKID0gZ3JlZ29yaWFuVG9KYWxhbGkodG9kYXlHLmdldEZ1bGxZZWFyKCksIHRvZGF5Ry5nZXRNb250aCgpICsgMSwgdG9kYXlHLmdldERhdGUoKSk7XHJcbiAgICB2YXIgc2VsZWN0ZWREYXRlSiA9IFtdO1xyXG4gICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgIHNlbGVjdGVkRGF0ZUpbaV0gPSB0b2RheXNKW2ldO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZGF5c1llYXIgPSB0b2RheXNKWzBdO1xyXG4gICAgdG9kYXlzTW9udGggPSB0b2RheXNKWzFdO1xyXG4gICAgdG9kYXlzRGF5ID0gdG9kYXlzSlsyXTtcclxuXHJcbiAgICBzZWxlY3RlZFllYXIgPSBzZWxlY3RlZERhdGVKWzBdO1xyXG4gICAgc2VsZWN0ZWRNb250aCA9IHNlbGVjdGVkRGF0ZUpbMV07XHJcbiAgICBzZWxlY3RlZERheSA9IHNlbGVjdGVkRGF0ZUpbMl07XHJcblxyXG4gICAgbW9udGhEcm9wZG93bi52YWwoc2VsZWN0ZWRNb250aCk7XHJcbiAgICBtYWtlWWVhckxpc3Qoc2VsZWN0ZWRZZWFyKTtcclxuICAgIHllYXJEcm9wZG93bi52YWwoc2VsZWN0ZWRZZWFyKTtcclxuXHJcbiAgICBudW1iZXJPZkRheXMgPSBtb250aERheXMoc2VsZWN0ZWRZZWFyLCBzZWxlY3RlZE1vbnRoKTtcclxuXHJcbiAgICAvLyBmaW5kIGZpcnN0IGRheSBvZiBtb250aCBpbiB3ZWVrXHJcbiAgICB2YXIgZmluZEZpcnN0RGF5T2ZNb250aCA9IGZ1bmN0aW9uIChzZWxlY3RlZFllYXIsIHNlbGVjdGVkTW9udGgpIHtcclxuICAgICAgICB2YXIgZmlyc3REYXlPZk1vbnRoRyA9IHRvR3JlZ29yaWFuKHNlbGVjdGVkWWVhciwgc2VsZWN0ZWRNb250aCwgMSk7XHJcbiAgICAgICAgZmlyc3REYXlPZk1vbnRoRyA9IG5ldyBEYXRlKGZpcnN0RGF5T2ZNb250aEcuZ3kgKyBcIi9cIiArIGZpcnN0RGF5T2ZNb250aEcuZ20gKyBcIi9cIiArIGZpcnN0RGF5T2ZNb250aEcuZ2QpO1xyXG4gICAgICAgIHJldHVybiBjb252ZXJ0VG9KV2VlayhmaXJzdERheU9mTW9udGhHLmdldERheSgpKTtcclxuICAgIH1cclxuICAgIGRheU9mV2Vla0ogPSBmaW5kRmlyc3REYXlPZk1vbnRoKHNlbGVjdGVkWWVhciwgc2VsZWN0ZWRNb250aCk7XHJcblxyXG4gICAgLy8gZHJhdyBkYXlzIG9uIGNhbGVuZGFyXHJcbiAgICB2YXIgZHJhd0RheXMgPSBmdW5jdGlvbiAobnVtYmVyT2ZEYXlzLCBkYXlPZldlZWtKKSB7XHJcbiAgICAgICAgZGF5c1RhYmxlLmVtcHR5KCk7XHJcbiAgICAgICAgdmFyIGRheUluZGV4ID0gMTtcclxuICAgICAgICB2YXIgcm93SW5kZXggPSAxO1xyXG4gICAgICAgIHdoaWxlIChkYXlJbmRleCA8PSBudW1iZXJPZkRheXMpIHtcclxuICAgICAgICAgICAgZGF5c1RhYmxlLmFwcGVuZCgkKCc8dHI+Jywge1xyXG4gICAgICAgICAgICAgICAgY2xhc3M6IFwidHItXCIgKyByb3dJbmRleFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCA3OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXlJbmRleCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGogPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgZGF5T2ZXZWVrSikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiI2JkLXRhYmxlLWRheXMtXCIgKyBlbGVtZW50SUQgKyBcIiAudHItMVwiKS5hcHBlbmQoJCgnPHRkPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImJkLWVtcHR5LWNlbGxcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDcgJiYgZGF5SW5kZXggPD0gbnVtYmVyT2ZEYXlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBURCA9ICc8dGQ+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiZGF5IGRheS0nICsgZGF5SW5kZXggKyAnXCIgdHlwZT1cImJ1dHRvblwiPicgKyAob3B0aW9ucy5mb3JjZUZhcnNpRGlnaXRzID8gRkFfTlVNU1tkYXlJbmRleF0gOiBkYXlJbmRleCkgKyAnPC9idXR0b24+JyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8L3RkPic7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hcmsgdG9kYXlzIGRheSBieSBhZGRpbmcgLmJkLXRvZGF5IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMubWFya1RvZGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXlJbmRleCA9PSB0b2RheXNEYXkgJiYgdG9kYXlzTW9udGggPT0gc2VsZWN0ZWRNb250aCAmJiB0b2RheXNZZWFyID09IHNlbGVjdGVkWWVhcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IHRlbXBURC5pbmRleE9mKCdkYXkgZGF5LScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFREID0gdGVtcFRELnNsaWNlKDAsIGlkeCkgKyAnIGJkLXRvZGF5ICcgKyB0ZW1wVEQuc2xpY2UoaWR4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbWFyayBob2xpZGF5cyBieSBhZGRpbmcgLmJkLWhvbGlkYXkgY2xhc3NcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tYXJrSG9saWRheXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gNikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IHRlbXBURC5pbmRleE9mKCdkYXkgZGF5LScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFREID0gdGVtcFRELnNsaWNlKDAsIGlkeCkgKyAnIGJkLWhvbGlkYXkgJyArIHRlbXBURC5zbGljZShpZHgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAkKFwiI2JkLXRhYmxlLWRheXMtXCIgKyBlbGVtZW50SUQgKyBcIiAudHItXCIgKyByb3dJbmRleCkuYXBwZW5kKHRlbXBURCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRheUluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcm93SW5kZXgrKztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvcHRpb25zLmhpZ2hsaWdodFNlbGVjdGVkRGF5KSB7XHJcbiAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gaW5wdXRFbGVtZW50LnZhbCgpO1xyXG4gICAgICAgICAgICBpbnB1dFZhbHVlID0gaW5wdXRWYWx1ZS5zcGxpdChcIi9cIik7XHJcbiAgICAgICAgICAgIGlmIChpbnB1dFZhbHVlWzBdID09IHNlbGVjdGVkWWVhciAmJiBpbnB1dFZhbHVlWzFdID09IHNlbGVjdGVkTW9udGgpIHtcclxuICAgICAgICAgICAgICAgIG1haW5EaXYuZmluZChcIi5iZC1zZWxlY3RlZC1kYXlcIikucmVtb3ZlQ2xhc3MoXCJiZC1zZWxlY3RlZC1kYXlcIik7XHJcbiAgICAgICAgICAgICAgICBtYWluRGl2LmZpbmQoXCIuZGF5LVwiICsgcGFyc2VJbnQoaW5wdXRWYWx1ZVsyXSkpLmFkZENsYXNzKFwiYmQtc2VsZWN0ZWQtZGF5XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBpbnB1dEVsZW1lbnQucGFyZW50KCkub24oXCJjbGlja1wiLCBcImJ1dHRvbi5kYXlcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBkYXRlc3RyID0gc2VsZWN0ZWRZZWFyICsgXCIvXCIgKyBzZWxlY3RlZE1vbnRoICsgXCIvXCIgKyAkKHRoaXMpLmF0dHIoJ2NsYXNzJykuc3BsaXQoXCIgXCIpWyQodGhpcykuYXR0cignY2xhc3MnKS5zcGxpdChcIiBcIikuaW5kZXhPZignZGF5JykgKyAxXS5zcGxpdChcIi1cIilbMV07XHJcbiAgICAgICAgaWYgKG9wdGlvbnMudHdvZGlnaXQpIHtcclxuICAgICAgICAgICAgZGF0ZXN0ciA9IGZpeERhdGUoZGF0ZXN0cik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlucHV0RWxlbWVudC52YWwoZGF0ZXN0cik7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LnRyaWdnZXIoXCJjaGFuZ2VcIik7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuY2xvc2VBZnRlclNlbGVjdCkge1xyXG4gICAgICAgICAgICBpc0NhbENsaWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgaW5wdXRFbGVtZW50LnRyaWdnZXIoXCJibHVyXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuaGlnaGxpZ2h0U2VsZWN0ZWREYXkpIHtcclxuICAgICAgICAgICAgbWFpbkRpdi5maW5kKFwiLmJkLXNlbGVjdGVkLWRheVwiKS5yZW1vdmVDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcclxuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcyhcImJkLXNlbGVjdGVkLWRheVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBuZXh0TW9udGgub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIm1vbnRoOiBcIiArIHNlbGVjdGVkTW9udGggKyBcIiwgeWVhcjogXCIgKyBzZWxlY3RlZFllYXIpO1xyXG4gICAgICAgIGlmIChtb250aERyb3Bkb3duLnZhbCgpIDwgMTIpIHtcclxuICAgICAgICAgICAgbW9udGhEcm9wZG93bi52YWwocGFyc2VJbnQobW9udGhEcm9wZG93bi52YWwoKSkgKyAxKTtcclxuICAgICAgICAgICAgbW9udGhEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udmFsKDEpO1xyXG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XHJcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi52YWwocGFyc2VJbnQoeWVhckRyb3Bkb3duLnZhbCgpKSArIDEpO1xyXG4gICAgICAgICAgICB5ZWFyRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBwcmV2TW9udGgub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKG1vbnRoRHJvcGRvd24udmFsKCkgPiAxKSB7XHJcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udmFsKHBhcnNlSW50KG1vbnRoRHJvcGRvd24udmFsKCkpIC0gMSk7XHJcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnZhbCgxMik7XHJcbiAgICAgICAgICAgIG1vbnRoRHJvcGRvd24udHJpZ2dlcihcImNoYW5nZVwiKTtcclxuICAgICAgICAgICAgeWVhckRyb3Bkb3duLnZhbChwYXJzZUludCh5ZWFyRHJvcGRvd24udmFsKCkpIC0gMSk7XHJcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChvcHRpb25zLmdvdG9Ub2RheSkge1xyXG4gICAgICAgIGdvdG9Ub2RheS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbW9udGhEcm9wZG93bi52YWwodG9kYXlzTW9udGgpO1xyXG4gICAgICAgICAgICBtb250aERyb3Bkb3duLnRyaWdnZXIoXCJjaGFuZ2VcIik7XHJcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi52YWwodG9kYXlzWWVhcik7XHJcbiAgICAgICAgICAgIHllYXJEcm9wZG93bi50cmlnZ2VyKFwiY2hhbmdlXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYXdEYXlzKG51bWJlck9mRGF5cywgZGF5T2ZXZWVrSik7XHJcblxyXG4gICAgLy8gZW5hYmxlIGJvb3RzdHJhcCB0b29sdGlwIGlmIGJvb3RzdHJhcCBpcyBsb2FkZWRcclxuICAgIGlmICh0eXBlb2YgJCgpLm1vZGFsID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAkKCdbZGF0YS10b2dnbGU9XCJ0b29sdGlwXCJdJykudG9vbHRpcCgpO1xyXG4gICAgfVxyXG5cclxufVxyXG4iLCIoZnVuY3Rpb24oKXtcclxuXHRmdW5jdGlvbiBqcmVzcChjb250ZXh0LCByZXMpXHJcblx0e1xyXG5cdFx0Y29udGV4dC50cmlnZ2VyKCdqcmVzcCcsIFtyZXNdKTtcclxuXHRcdGlmIChyZXMubWVzc2FnZSAmJiAhY29udGV4dC5pcygnLmQtbm90aWZpY2F0aW9uJykpXHJcblx0XHR7XHJcblx0XHRcdGlmICh3aW5kb3cudG9hc3RyKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dmFyIHRvYXN0ID0gdG9hc3RyW3Jlcy5pc19vayA/ICdzdWNjZXNzJyA6ICdlcnJvciddKHJlcy5tZXNzYWdlX3RleHQgfHwgcmVzLm1lc3NhZ2UsIHVuZGVmaW5lZCwge1xyXG5cdFx0XHRcdFx0XCJjbG9zZUJ1dHRvblwiOiB0cnVlLFxyXG5cdFx0XHRcdFx0XCJuZXdlc3RPblRvcFwiOiB0cnVlLFxyXG5cdFx0XHRcdFx0XCJwb3NpdGlvbkNsYXNzXCI6IFwidG9hc3QtYm90dG9tLXJpZ2h0XCIsXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAod2luZG93Lml6aVRvYXN0KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aXppVG9hc3RbcmVzLmlzX29rID8gJ3N1Y2Nlc3MnIDogJ2Vycm9yJ10oeyBtZXNzYWdlOiByZXMubWVzc2FnZV90ZXh0IHx8IHJlcy5tZXNzYWdlfSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmKHJlcy5yZWRpcmVjdClcclxuXHRcdHtcclxuXHRcdFx0aWYocmVzLmRpcmVjdClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGxvY2F0aW9uLmhyZWYgPSByZXMucmVkaXJlY3Q7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0bmV3IFN0YXRpbyh7XHJcblx0XHRcdFx0XHR1cmwgOiByZXMucmVkaXJlY3RcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHR3aW5kb3cuSlJlc3AgPSBqcmVzcDtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRmdW5jdGlvbiBsaWpheChjb250ZXh0LCBvbkZpcmUpXHJcblx0e1xyXG4gICAgICAgIHZhciBiYWNrX3ZhbHVlID0gJChjb250ZXh0KS52YWwoKSB8fCAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtdmFsdWUnKTtcclxuICAgICAgICBpZigkKGNvbnRleHQpLmlzKCc6Y2hlY2tib3gnKSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJhY2tfdmFsdWUgPSAkKGNvbnRleHQpLmlzKCc6Y2hlY2tlZCcpID8gMSA6IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBUaW1lb3V0ID0gbnVsbDtcclxuICAgICAgICB2YXIgZmlyZSA9IG51bGw7XHJcbiAgICAgICAgaWYoJChjb250ZXh0KS5pcygnZm9ybScpICYmICEkKGNvbnRleHQpLmF0dHIoJ2RhdGEtbGlqYXgnKSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZpcmUgPSBbJ3N1Ym1pdCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmaXJlID0gJChjb250ZXh0KS5hdHRyKCdkYXRhLWxpamF4Jykuc3BsaXQoJyAnKSB8fCBbJ2NoYW5nZSddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpcmUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYoL15cXGQrJC8udGVzdChmaXJlW2ldKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIFRpbWUgPSBmaXJlW2ldO1xyXG4gICAgICAgICAgICAgICAgJChjb250ZXh0KS5vbigna2V5dXAnLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKFRpbWVvdXQpIGNsZWFyVGltZW91dChUaW1lb3V0KTtcclxuICAgICAgICAgICAgICAgICAgICBUaW1lb3V0ID0gc2V0VGltZW91dChzZW5kLCBUaW1lKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgJChjb250ZXh0KS5vbihmaXJlW2ldLCBzZW5kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VuZCgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaHJlZiA9IHVybC5wYXJzZShsb2NhdGlvbi5ocmVmKTtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSAkKGNvbnRleHQpLmF0dHIoJ25hbWUnKSB8fCAkKGNvbnRleHQpLmF0dHIoJ2RhdGEtbmFtZScpO1xyXG4gICAgICAgICAgICBpZihocmVmLmdldCAmJiBocmVmLmdldFtuYW1lXSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIGhyZWYuZ2V0W25hbWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBnZXQgPSB1cmwuYnVpbGRnZXQoaHJlZi5nZXQpO1xyXG4gICAgICAgICAgICBocmVmID0gaHJlZi51cmwucmVwbGFjZSgvXFw/KC4qKSQvLCBnZXQgPyAnPycgKyBnZXQgOiAnJyk7XHJcbiAgICAgICAgICAgIHZhciBhY3Rpb24gPSAkKGNvbnRleHQpLmF0dHIoJ2hyZWYnKSB8fCAkKGNvbnRleHQpLmF0dHIoJ2FjdGlvbicpIHx8ICQoY29udGV4dCkuYXR0cignZGF0YS1hY3Rpb24nKSB8fCBocmVmO1xyXG4gICAgICAgICAgICB2YXIgbWV0aG9kID0gJChjb250ZXh0KS5hdHRyKCdkYXRhLW1ldGhvZCcpIHx8ICQoY29udGV4dCkuYXR0cignbWV0aG9kJykgfHwgJ0dFVCc7XHJcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9ICQoY29udGV4dCkuYXR0cignZGF0YS1zdGF0ZScpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmKCQoY29udGV4dCkuaXMoJ2Zvcm0nKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIERhdGEgPSBuZXcgRm9ybURhdGEoY29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xyXG5cdFx0XHRcdGlmICgkKGNvbnRleHQpLmF0dHIoJ2VuY3R5cGUnKSA9PSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScgfHwgJCgnaW5wdXQ6ZmlsZScsIGNvbnRleHQpLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhID0gRGF0YTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBEYXRhLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbbmFtZV0gPSAvXFxbLipcXF0kLy50ZXN0KG5hbWUpID8gRGF0YS5nZXRBbGwobmFtZSkgOiBEYXRhLmdldChuYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXRlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkKGNvbnRleHQpLmFkZENsYXNzKCdsaWpheC1zZW5kaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAkKCdpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYnV0dG9uJywgY29udGV4dCkubm90KCc6ZGlzYWJsZWQnKS5hZGRDbGFzcygnbGlqYXgtZGlzYWJsZScpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XHJcbiAgICAgICAgICAgICAgICAkKGNvbnRleHQpLm9uKCdzdGF0aW86ZG9uZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkKCcubGlqYXgtZGlzYWJsZScsIHRoaXMpLnJlbW92ZUNsYXNzKCdsaWpheC1kaXNhYmxlJykucmVtb3ZlQXR0cignZGlzYWJsZWQnKVxyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2xpamF4LXNlbmRpbmcnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSAkKGNvbnRleHQpLnZhbCgpIHx8ICQoY29udGV4dCkuYXR0cignZGF0YS12YWx1ZScpIHx8IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZigkKGNvbnRleHQpLmlzKCc6Y2hlY2tib3gnKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICQoY29udGV4dCkuaXMoJzpjaGVja2VkJykgPyAxIDogMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKGJhY2tfdmFsdWUgPT0gdmFsdWUgJiYgJChjb250ZXh0KS5pcygnaW5wdXQsIHRleHRhcmVhLCBzZWxlY3QnKSAmJiAhb25GaXJlKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBiYWNrX3ZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZGF0YVtuYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkKGNvbnRleHQpLmF0dHIoJ2RhdGEtcXVlcnknKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbl9xdWVyeSA9IHVybC5wYXJzZShhY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFfcXVlcnkgPSB1cmwucGFyc2UoJz8nICsgJChjb250ZXh0KS5hdHRyKCdkYXRhLXF1ZXJ5JykpO1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uX3F1ZXJ5LmdldCA9ICQuZXh0ZW5kKG51bGwsIChhY3Rpb25fcXVlcnkuZ2V0IHx8IHt9KSwgZGF0YV9xdWVyeS5nZXQpO1xyXG4gICAgICAgICAgICAgICAgYWN0aW9uID0gdXJsLmJ1aWxkKGFjdGlvbl9xdWVyeSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSB7fTtcclxuICAgICAgICAgICAgaWYgKCQoY29udGV4dCkuYXR0cignZGF0YS14aHJCYXNlJykpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ0RhdGEteGhyLWJhc2UnOiAkKGNvbnRleHQpLmF0dHIoJ2RhdGEteGhyQmFzZScpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5ldyBTdGF0aW8oe1xyXG4gICAgICAgICAgICAgICAgdHlwZSA6IHN0YXRlID8gJ2JvdGgnIDogJ3JlbmRlcicsXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0OiBjb250ZXh0LFxyXG4gICAgICAgICAgICAgICAgYWpheCA6IHtcclxuXHRcdFx0XHRcdGNvbnRlbnRUeXBlOiAkKGNvbnRleHQpLmlzKCdmb3JtJykgJiYgKCQoY29udGV4dCkuYXR0cignZW5jdHlwZScpID09ICdtdWx0aXBhcnQvZm9ybS1kYXRhJyB8fCAkKCdpbnB1dDpmaWxlJywgY29udGV4dCkubGVuZ3RoKSA/IGZhbHNlIDogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCcsXHJcblx0XHRcdFx0XHRwcm9jZXNzRGF0YTogKCQoY29udGV4dCkuaXMoJ2Zvcm0nKSAmJiAoJChjb250ZXh0KS5hdHRyKCdlbmN0eXBlJykgPT0gJ211bHRpcGFydC9mb3JtLWRhdGEnIHx8ICQoJ2lucHV0OmZpbGUnLCBjb250ZXh0KS5sZW5ndGgpKSA/IGZhbHNlIDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjYWNoZSAgICAgICA6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZCA6IG1ldGhvZCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhIDogZGF0YSxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdXJsIDogYWN0aW9uXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvbkZpcmUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzZW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgd2luZG93LkxpamF4ID0gbGlqYXg7XHJcbn0pKCk7IiwidmFyIG1lZGlhX3htID0gd2luZG93Lm1hdGNoTWVkaWEoXCIobWF4LXdpZHRoOiA1NzUuOThweClcIik7XHJcbnZhciBtZWRpYV9zbSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogNTc2cHgpIGFuZCAobWF4LXdpZHRoOiA3NjcuOThweClcIik7XHJcbnZhciBtZWRpYV9tZCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogNzY4cHgpIGFuZCAobWF4LXdpZHRoOiA5OTEuOThweClcIik7XHJcbnZhciBtZWRpYV9sZyA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi13aWR0aDogOTkycHgpIGFuZCAobWF4LXdpZHRoOiAxMTk5Ljk4cHgpXCIpO1xyXG52YXIgbWVkaWFfeGwgPSB3aW5kb3cubWF0Y2hNZWRpYShcIihtaW4td2lkdGg6IDEyMDBweClcIik7XHJcblxyXG5cclxuZnVuY3Rpb24gZXZlbnRfbWVkaWFfeG0obWVkaWEpe1xyXG5cdGlmKG1lZGlhLm1hdGNoZXMpIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTp4bScsIFttZWRpYV0pO1xyXG5cdGVsc2UgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnhtOmV4aXQnLCBbbWVkaWFdKTtcclxufVxyXG5mdW5jdGlvbiBldmVudF9tZWRpYV9zbShtZWRpYSl7XHJcblx0aWYobWVkaWEubWF0Y2hlcykgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnNtJywgW21lZGlhXSk7XHJcblx0ZWxzZSByZXR1cm4gJChkb2N1bWVudCkudHJpZ2dlcignbWVkaWE6c206ZXhpdCcsIFttZWRpYV0pO1xyXG59XHJcbmZ1bmN0aW9uIGV2ZW50X21lZGlhX21kKG1lZGlhKXtcclxuXHRpZihtZWRpYS5tYXRjaGVzKSByZXR1cm4gJChkb2N1bWVudCkudHJpZ2dlcignbWVkaWE6bWQnLCBbbWVkaWFdKTtcclxuXHRlbHNlIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTptZDpleGl0JywgW21lZGlhXSk7XHJcbn1cclxuZnVuY3Rpb24gZXZlbnRfbWVkaWFfbGcobWVkaWEpe1xyXG5cdGlmKG1lZGlhLm1hdGNoZXMpIHJldHVybiAkKGRvY3VtZW50KS50cmlnZ2VyKCdtZWRpYTpsZycsIFttZWRpYV0pO1xyXG5cdGVsc2UgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOmxnOmV4aXQnLCBbbWVkaWFdKTtcclxufVxyXG5mdW5jdGlvbiBldmVudF9tZWRpYV94bChtZWRpYSl7XHJcblx0aWYobWVkaWEubWF0Y2hlcykgcmV0dXJuICQoZG9jdW1lbnQpLnRyaWdnZXIoJ21lZGlhOnhsJywgW21lZGlhXSk7XHJcblx0ZWxzZSByZXR1cm4gJChkb2N1bWVudCkudHJpZ2dlcignbWVkaWE6eGw6ZXhpdCcsIFttZWRpYV0pO1xyXG59XHJcblxyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xyXG5cdGV2ZW50X21lZGlhX3htKG1lZGlhX3htKTtcclxuXHRtZWRpYV94bS5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV94bSk7XHJcblxyXG5cdGV2ZW50X21lZGlhX3NtKG1lZGlhX3NtKTtcclxuXHRtZWRpYV9zbS5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV9zbSk7XHJcblxyXG5cdGV2ZW50X21lZGlhX21kKG1lZGlhX21kKTtcclxuXHRtZWRpYV9tZC5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV9tZCk7XHJcblxyXG5cdGV2ZW50X21lZGlhX2xnKG1lZGlhX2xnKTtcclxuXHRtZWRpYV9sZy5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV9sZyk7XHJcblxyXG5cdGV2ZW50X21lZGlhX3hsKG1lZGlhX3hsKTtcclxuXHRtZWRpYV94bC5hZGRMaXN0ZW5lcihldmVudF9tZWRpYV94bCk7XHJcbn0pXHJcbiIsImZ1bmN0aW9uIHJlc3BvbnNpdmVfbWVudSgpIHtcclxuICAgICQoJyNtZW51JykucmVtb3ZlQ2xhc3MoJ2Qtbm9uZScpLmFkZENsYXNzKCdkLWZsZXgnKTtcclxuICAgIC8vICQoJyNkZXNrdG9wJykucmVtb3ZlQ2xhc3MoJ2Qtbm9uZScpO1xyXG4gICAgJCgnYm9keScpLmFkZENsYXNzKCdyZXNwb25zaXZlLW1lbnUnKTtcclxuICAgICQoJyNidG4tbWVudScpLmZpbmQoJChcIi5mYXNcIikpLnJlbW92ZUNsYXNzKCdmYS1iYXJzJykuYWRkQ2xhc3MoJ2ZhLWFycm93LXJpZ2h0Jyk7XHJcbiAgICAkKHRoaXMpLm9mZignY2xpY2sucmVzcG9uc2l2ZS1tZW51Jyk7XHJcbiAgICAkKHRoaXMpLm9uKCdjbGljay5jbG9zZS1yZXNwb25zaXZlLW1lbnUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLm9mZignY2xpY2suY2xvc2UtcmVzcG9uc2l2ZS1tZW51Jyk7XHJcbiAgICAgICAgJCh0aGlzKS5vbignY2xpY2sucmVzcG9uc2l2ZS1tZW51JywgcmVzcG9uc2l2ZV9tZW51KTtcclxuICAgICAgICAkKCcjbWVudScpLmFkZENsYXNzKCdkLW5vbmUnKS5yZW1vdmVDbGFzcygnZC1mbGV4Jyk7XHJcbiAgICAgICAgLy8gJCgnI2Rlc2t0b3AnKS5hZGRDbGFzcygnZC1ub25lJyk7XHJcbiAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdyZXNwb25zaXZlLW1lbnUnKTtcclxuICAgICAgICAkKCcjYnRuLW1lbnUnKS5maW5kKCQoXCIuZmFzXCIpKS5yZW1vdmVDbGFzcygnZmEtYXJyb3ctcmlnaHQnKS5hZGRDbGFzcygnZmEtYmFycycpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbiQoZG9jdW1lbnQpLm9uKCdtZWRpYTp4bSBtZWRpYTpzbScsIGZ1bmN0aW9uKGV2ZW50LCBtZWRpYSkge1xyXG4gICAgJChcImJvZHk6bm90KC5yZXNwb25zaXZlLW1lbnUpICNidG4tbWVudVwiKS5vbignY2xpY2sucmVzcG9uc2l2ZS1tZW51JywgcmVzcG9uc2l2ZV9tZW51KTtcclxuXHJcbiAgICB2YXIgbWVudSA9ICQoJyNtZW51Jyk7XHJcbiAgICB2YXIgZGVza3RvcCA9ICQoJyNkZXNrdG9wJyk7XHJcbiAgICB2YXIgYnRuX21lbnUgPSAkKCcjYnRuLW1lbnUnKTtcclxuICAgICQoZG9jdW1lbnQpLm1vdXNldXAoZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgKCFtZW51LmlzKGUudGFyZ2V0KSAmJiBtZW51LmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICAmJiAoIWRlc2t0b3AuaXMoZS50YXJnZXQpICYmIGRlc2t0b3AuaGFzKGUudGFyZ2V0KS5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgICYmICghYnRuX21lbnUuaXMoZS50YXJnZXQpICYmIGJ0bl9tZW51LmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAkKFwiYm9keS5yZXNwb25zaXZlLW1lbnUgI2J0bi1tZW51XCIpLnRyaWdnZXIoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vICQoXCJib2R5XCIpLnN3aXBlKHtcclxuICAgIC8vICAgICBzd2lwZTogZnVuY3Rpb24oZXZlbnQsIGRpcmVjdGlvbiwgZGlzdGFuY2UsIGR1cmF0aW9uLCBmaW5nZXJDb3VudCwgZmluZ2VyRGF0YSkge1xyXG4gICAgLy8gICAgICAgICBpZiAoZGlyZWN0aW9uID09ICdsZWZ0Jykge1xyXG4gICAgLy8gICAgICAgICAgICAgJChcImJvZHk6bm90KC5yZXNwb25zaXZlLW1lbnUpICNidG4tbWVudVwiKS50cmlnZ2VyKCdjbGljay5yZXNwb25zaXZlLW1lbnUnKTtcclxuICAgIC8vICAgICAgICAgfVxyXG5cclxuICAgIC8vICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PSAncmlnaHQnKSB7XHJcbiAgICAvLyAgICAgICAgICAgICAkKFwiYm9keS5yZXNwb25zaXZlLW1lbnUgI2J0bi1tZW51XCIpLnRyaWdnZXIoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xyXG4gICAgLy8gICAgICAgICB9XHJcblxyXG4gICAgLy8gICAgICAgICBpZiAoZGlyZWN0aW9uID09ICd1cCcgfHwgZGlyZWN0aW9uID09ICdkb3duJykge1xyXG4gICAgLy8gICAgICAgICAgICAgaWYgKCFtZW51LmlzKGV2ZW50LnRhcmdldCkgJiYgbWVudS5oYXMoZXZlbnQudGFyZ2V0KS5sZW5ndGggPT09IDApIHtcclxuICAgIC8vICAgICAgICAgICAgICAgICAkKFwiYm9keS5yZXNwb25zaXZlLW1lbnUgI2J0bi1tZW51XCIpLnRyaWdnZXIoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xyXG4gICAgLy8gICAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfSk7XHJcbn0pO1xyXG5cclxuJChkb2N1bWVudCkub24oJ21lZGlhOm1kIG1lZGlhOmxnIG1lZGlhOnhsJywgZnVuY3Rpb24oZXZlbnQsIG1lZGlhKSB7XHJcbiAgICAkKFwiYm9keS5yZXNwb25zaXZlLW1lbnUgI2J0bi1tZW51XCIpLnRyaWdnZXIoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xyXG4gICAgJChcIiNidG4tbWVudVwiKS5vZmYoJ2NsaWNrLnJlc3BvbnNpdmUtbWVudScpO1xyXG4gICAgLy8gJChcIiNidG4tbWVudVwiKS5vZmYoJ2NsaWNrLmNsb3NlLXJlc3BvbnNpdmUtbWVudScpO1xyXG4gICAgLy8gJCgnI21lbnUnKS5hZGRDbGFzcygnZC1ub25lJykucmVtb3ZlQ2xhc3MoJ2QtZmxleCcpO1xyXG4gICAgLy8gJCgnI2Rlc2t0b3AnKS5hZGRDbGFzcygnZC1ub25lJyk7XHJcbiAgICAvLyAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ3Jlc3BvbnNpdmUtbWVudScpO1xyXG4gICAgLy8gJCgnI2J0bi1tZW51JykuZmluZCgkKFwiLmZhc1wiKSkucmVtb3ZlQ2xhc3MoJ2ZhLWFycm93LXJpZ2h0JykuYWRkQ2xhc3MoJ2ZhLWJhcnMnKTtcclxufSk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIF9nbG9iYWxzID0ge1xyXG5cdFx0dGl0bGUgOiBmdW5jdGlvbiAodmFsdWUpe1xyXG5cdFx0XHQkKCd0aXRsZScpLmh0bWwodmFsdWUpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0dmFyIF9hamF4ID0ge1xyXG5cdFx0dHlwZSA6ICdHRVQnLFxyXG5cdFx0Y2FjaGUgOiBmYWxzZVxyXG5cdH1cclxuXHJcblx0dmFyIF9vcHRpb25zID0ge1xyXG5cdFx0b2JqZWN0IDogbnVsbCxcclxuXHRcdHRpdGxlIDogbnVsbCxcclxuXHRcdGFqYXggOiBfYWpheCxcclxuXHQvKipcclxuXHQgKiBTZW5kIHJlcXVlc3QgYW5kIGNoYW5nZSB1cmwgd2l0aCByZXNwb25zZSByZW5kZXJpbmdcclxuXHQgKiBAZGVmYXVsdCBib3RoXHJcblx0ICogYm90aDogY2hhbmdlIHVybCBhbmQgcmVuZGVyIHJlc3BvbnNlXHJcblx0ICogdXJsOiBPbmx5IHNlbmQgcmVxdWVzdCBhbmQgY2hhZ2UgdXJsIHdpdGhvdXQgY2hhbmdlIHJlbmRlcmluZ1xyXG5cdCAqIHJlbmRlcjogT25seSBzZW5kIHJlcXVlc3QgYW5kIHJlbmRlciByZXBzb25zZSB3aXRob3V0IGNoYW5nZSB1cmxcclxuXHQgKiBAdHlwZSB7U3RyaW5nfVxyXG5cdCAqL1xyXG5cdCB0eXBlIDogJ2JvdGgnLFxyXG5cdC8qKlxyXG5cdCAqIGRvbnQgc2VuZCBhbnkgcmVxdWVzdFxyXG5cdCAqIEB0eXBlIHtCb29sZWFufVxyXG5cdCAqL1xyXG5cdCBmYWtlIDogZmFsc2UsXHJcblx0LyoqXHJcblx0ICogYWpheCByZXNwb25zZSBjb250ZXRudFxyXG5cdCAqIGlmIHtmYWtlOnRydWV9IG9yIHtyZXNwb25zZSA6IG5vdG51bGx9IHJlc3BvbnNlIHJlbmRlciB0aGlzIHByb3BlcnR5XHJcblx0ICogQHR5cGUge1t0eXBlXX1cclxuXHQgKi9cclxuXHQgcmVzcG9uc2UgOiBudWxsLFxyXG5cdC8qKlxyXG5cdCAqIHJlcGxhY2Ugc3RhdGVcclxuXHQgKiBAdHlwZSB7Qm9vbGVhbn1cclxuXHQgKi9cclxuXHQgcmVwbGFjZSA6IGZhbHNlLFxyXG5cdC8qKlxyXG5cdCAqIGV2ZW50IGNvbnRleHRcclxuXHQgKiBAdHlwZSB7RE9NfSB7alF1ZXJ5fSB7U2VsZWN0b3Igc3RyaW5nfVxyXG5cdCAqL1xyXG5cdCBjb250ZXh0IDogZG9jdW1lbnRcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHN0YXRpbyhjdXN0b20pe1xyXG5cdFx0aWYodHlwZW9mIGN1c3RvbSAhPSAnb2JqZWN0JylcclxuXHRcdHtcclxuXHRcdFx0Y3VzdG9tID0ge307XHJcblx0XHR9XHJcblxyXG5cdFx0Y3VzdG9tLmFqYXggPSAkLmV4dGVuZCh7fSwgX2FqYXgsIGN1c3RvbS5hamF4KTtcclxuXHRcdGN1c3RvbS5hamF4LnVybCA9IGN1c3RvbS51cmw7XHJcblx0XHRjdXN0b20uZ2xvYmFscyA9ICQuZXh0ZW5kKHt9LCBfZ2xvYmFscywgY3VzdG9tLmdsb2JhbHMpO1xyXG5cdFx0dmFyIG9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgX29wdGlvbnMsIGN1c3RvbSk7XHJcblxyXG5cdFx0dmFyIHJlc3BvbnNlID0ge1xyXG5cdFx0XHRib2R5IDogb3B0aW9ucy5yZXNwb25zZSxcclxuXHRcdFx0ZGF0YSA6IHt9LFxyXG5cdFx0fTtcclxuXHJcblx0XHRpZighKG9wdGlvbnMuY29udGV4dCBpbnN0YW5jZW9mIGpRdWVyeSkpXHJcblx0XHR7XHJcblx0XHRcdG9wdGlvbnMuY29udGV4dCA9ICQob3B0aW9ucy5jb250ZXh0KTtcclxuXHRcdH1cclxuXHJcblx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCdzdGF0aW86Z2xvYmFsOmluaXQnLCBbb3B0aW9ucy5jb250ZXh0XSk7XHJcblx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmluaXQnKTtcclxuXHJcblxyXG5cdFx0dmFyIGFqYXhfZGF0YSA9IG51bGw7XHJcblx0XHR2YXIgYWpheF9zZW5kX3VybCA9IG51bGw7XHJcblx0XHRpZighb3B0aW9ucy5mYWtlKVxyXG5cdFx0e1xyXG5cdFx0XHRpZighb3B0aW9ucy5hamF4LmNvbXBsZXRlKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0b3B0aW9ucy5hamF4LmNvbXBsZXRlID0gYWp4X2NvbXBsZXRlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBiZWZvcmVTZW5kID0gb3B0aW9ucy5hamF4LmJlZm9yZVNlbmQ7XHJcblx0XHRcdG9wdGlvbnMuYWpheC5iZWZvcmVTZW5kID0gZnVuY3Rpb24oanFYSFIsIHNldHRpbmdzKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0YWpheF9kYXRhID0gdGhpcztcclxuXHRcdFx0XHRhamF4X3NlbmRfdXJsID0gdGhpcy51cmw7XHJcblx0XHRcdFx0dmFyIHVybHggPSB1cmwucGFyc2UoYWpheF9zZW5kX3VybCk7XHJcblx0XHRcdFx0aWYodXJseC5nZXQgJiYgdXJseC5nZXQuXylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRkZWxldGUgdXJseC5nZXQuXztcclxuXHRcdFx0XHR9XHJcbiAgICAgICAgICAgIFx0dmFyIGdldCA9IHVybC5idWlsZGdldCh1cmx4LmdldCk7XHJcbiAgICAgICAgICAgIFx0YWpheF9zZW5kX3VybCA9IHVybHgudXJsLnJlcGxhY2UoL1xcPyguKikkLywgZ2V0ID8gJz8nICsgZ2V0IDogJycpO1xyXG5cdFx0XHRcdGJlZm9yZVNlbmQgPyBiZWZvcmVTZW5kLmNhbGwodGhpcywganFYSFIsIHNldHRpbmdzKSA6IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdFx0JC5hamF4KG9wdGlvbnMuYWpheCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKG9wdGlvbnMudHlwZSAhPSAndXJsJyAmJiByZXNwb25zZS5ib2R5KVxyXG5cdFx0e1xyXG5cdFx0XHRyZXNwb25zZV9wYXJzZSgpO1xyXG5cdFx0XHRyZW5kZXIoKTtcclxuXHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpkb25lJywgW29wdGlvbnMuY29udGV4dF0pO1xyXG5cdFx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmRvbmUnKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRvcHRpb25zLnJlcGxhY2VcclxuXHRcdFx0XHRcdD8gaGlzdG9yeS5yZXBsYWNlU3RhdGUoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcHRpb25zKSksIG9wdGlvbnMudGl0bGUsIGFqYXhfc2VuZF91cmwgfHwgb3B0aW9ucy51cmwpXHJcblx0XHRcdFx0XHQ6IGhpc3RvcnkucHVzaFN0YXRlKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob3B0aW9ucykpLCBvcHRpb25zLnRpdGxlLCBhamF4X3NlbmRfdXJsIHx8IG9wdGlvbnMudXJsKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRjYXRjaCAoZSkge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpkb25lJywgW29wdGlvbnMuY29udGV4dF0pO1xyXG5cdFx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmRvbmUnKTtcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBhanhfY29tcGxldGUoanFYSFIsIHRleHRTdGF0dXMpXHJcblx0XHR7XHJcblx0XHRcdGlmKGpxWEhSLnJlc3BvbnNlSlNPTilcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHJlc3BvbnNlLmRhdGEgPSBqcVhIUi5yZXNwb25zZUpTT047XHJcblx0XHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpqc29uUmVzcG9uc2UnLCBbb3B0aW9ucy5jb250ZXh0LCBqcVhIUi5yZXNwb25zZUpTT04sIGpxWEhSXSk7XHJcblx0XHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpqc29uUmVzcG9uc2UnLCBbanFYSFIucmVzcG9uc2VKU09OLCBqcVhIUl0pO1xyXG5cdFx0XHRcdG5ldyBKUmVzcChvcHRpb25zLmNvbnRleHQsIHJlc3BvbnNlLmRhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHJlc3BvbnNlLmJvZHkgPSBqcVhIUi5yZXNwb25zZVRleHQ7XHJcblx0XHRcdFx0cmVzcG9uc2VfcGFyc2UoKTtcclxuXHRcdFx0XHRpZih0ZXh0U3RhdHVzID09ICdzdWNjZXNzJylcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRpZiAob3B0aW9ucy50eXBlICE9ICdyZW5kZXInKSB7XHJcblx0XHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdFx0b3B0aW9ucy5yZXNwb25zZSA9IHJlc3BvbnNlO1xyXG5cdFx0XHRcdFx0XHRcdG9wdGlvbnMucmVwbGFjZVxyXG5cdFx0XHRcdFx0XHRcdFx0PyBoaXN0b3J5LnJlcGxhY2VTdGF0ZShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKSwgb3B0aW9ucy50aXRsZSwgYWpheF9zZW5kX3VybCB8fCBvcHRpb25zLnVybClcclxuXHRcdFx0XHRcdFx0XHRcdDogaGlzdG9yeS5wdXNoU3RhdGUoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcHRpb25zKSksIG9wdGlvbnMudGl0bGUsIGFqYXhfc2VuZF91cmwgfHwgb3B0aW9ucy51cmwpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRcdFx0dHJ5e1xyXG5cdFx0XHRcdFx0XHRcdFx0b3B0aW9ucy5yZXBsYWNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdD8gaGlzdG9yeS5yZXBsYWNlU3RhdGUob3B0aW9ucy5kYXRhLCBvcHRpb25zLnRpdGxlLCBhamF4X3NlbmRfdXJsIHx8IG9wdGlvbnMudXJsKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQ6IGhpc3RvcnkucHVzaFN0YXRlKG9wdGlvbnMuZGF0YSwgb3B0aW9ucy50aXRsZSwgYWpheF9zZW5kX3VybCB8fCBvcHRpb25zLnVybCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRjYXRjaCAoZSl7XHJcblx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKGUpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpzdWNjZXNzJywgW29wdGlvbnMuY29udGV4dCwgcmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuYm9keSwganFYSFJdKTtcclxuXHRcdFx0XHRcdG9wdGlvbnMuY29udGV4dC50cmlnZ2VyKCdzdGF0aW86c3VjY2VzcycsIFtyZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5LCBqcVhIUl0pO1xyXG5cdFx0XHRcdFx0aWYob3B0aW9ucy50eXBlICE9ICd1cmwnKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRyZW5kZXIoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdCQoZG9jdW1lbnQpLnRyaWdnZXIoJ3N0YXRpbzpnbG9iYWw6ZXJyb3JSZXNwb25zZScsIFtvcHRpb25zLmNvbnRleHQsIHJlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmJvZHksIGpxWEhSXSk7XHJcblx0XHRcdFx0XHRvcHRpb25zLmNvbnRleHQudHJpZ2dlcignc3RhdGlvOmVycm9yUmVzcG9uc2UnLCBbcmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuYm9keSwganFYSFJdKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcignc3RhdGlvOmdsb2JhbDpkb25lJywgW29wdGlvbnMuY29udGV4dCwgcmVzcG9uc2UuZGF0YSwgcmVzcG9uc2UuYm9keSwganFYSFJdKTtcclxuXHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpkb25lJywgW3Jlc3BvbnNlLmRhdGEsIHJlc3BvbnNlLmJvZHksIGpxWEhSXSk7XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gcmVzcG9uc2VfcGFyc2UoKXtcclxuXHRcdFx0aWYodHlwZW9mIHJlc3BvbnNlLmJvZHkgPT0gJ3N0cmluZycpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0cnlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR2YXIgc3BsaXQgICAgID0gcmVzcG9uc2UuYm9keS5zcGxpdChcIlxcblwiKTtcclxuXHRcdFx0XHRcdHJlc3BvbnNlLmRhdGEgPSBKU09OLnBhcnNlKHNwbGl0WzBdKTtcclxuXHRcdFx0XHRcdHJlc3BvbnNlLmJvZHkgPSBzcGxpdC5sZW5ndGggPiAxID8gJCgkLnBhcnNlSFRNTChzcGxpdC5zcGxpY2UoMSkuam9pbihcIlwiKSkpIDogbnVsbDtcclxuXHRcdFx0XHR9Y2F0Y2goZSl7XHJcblx0XHRcdFx0XHRyZXNwb25zZS5ib2R5ICA9ICQoJC5wYXJzZUhUTUwocmVzcG9uc2UuYm9keSkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmKHR5cGVvZiByZXNwb25zZS5ib2R5ID09ICdvYmplY3QnICYmIHJlc3BvbnNlLmJvZHkgIT0gbnVsbClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKHJlc3BvbnNlLmJvZHkgaW5zdGFuY2VvZiBIVE1MRWxlbWVudClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRyZXNwb25zZS5ib2R5ICA9ICQocmVzcG9uc2UuYm9keSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYocmVzcG9uc2UuYm9keSBpbnN0YW5jZW9mIGpRdWVyeSlcclxuXHRcdFx0XHR7XHJcblxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0cmVzcG9uc2UuZGF0YSA9IHJlc3BvbnNlLmJvZHk7XHJcblx0XHRcdFx0XHRyZXNwb25zZS5ib2R5ID0gbnVsbDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiByZW5kZXIoKXtcclxuXHRcdFx0Zm9yKEQgaW4gcmVzcG9uc2UuZGF0YSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKG9wdGlvbnMuZ2xvYmFsc1tEXSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRvcHRpb25zLmdsb2JhbHNbRF0ocmVzcG9uc2UuZGF0YVtEXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHJlc3BvbnNlLmJvZHkpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgY2hhbmdlZCA9IFtdO1xyXG5cdFx0XHRcdHJlc3BvbnNlLmJvZHkuZWFjaChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdFx0dmFyIGJhc2UgPSAkKHRoaXMpLmF0dHIoJ2RhdGEteGhyJyk7XHJcblx0XHRcdFx0XHRpZihiYXNlKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRjaGFuZ2VkLnB1c2goJChcIltkYXRhLXhocj0nXCIrYmFzZStcIiddXCIpKTtcclxuXHRcdFx0XHRcdFx0JChcIltkYXRhLXhocj0nXCIrYmFzZStcIiddXCIpLmh0bWwoJCh0aGlzKS5odG1sKCkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdCQoZG9jdW1lbnQpLnRyaWdnZXIoJ3N0YXRpbzpnbG9iYWw6cmVuZGVyUmVzcG9uc2UnLCBbJChjaGFuZ2VkKSwgb3B0aW9ucy5jb250ZXh0LCByZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5XSk7XHJcblx0XHRcdFx0b3B0aW9ucy5jb250ZXh0LnRyaWdnZXIoJ3N0YXRpbzpyZW5kZXJSZXNwb25zZScsIFskKGNoYW5nZWQpLCByZXNwb25zZS5kYXRhLCByZXNwb25zZS5ib2R5XSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHR3aW5kb3cuU3RhdGlvID0gc3RhdGlvO1xyXG5cdC8qKlxyXG5cdCAqIGZvciBuZXcgY2hyb21lIGJ1Z1xyXG5cdCAqL1xyXG5cdCBuZXcgU3RhdGlvKHtcclxuXHQgXHR1cmwgOiBsb2NhdGlvbi5ocmVmLFxyXG5cdCBcdGZha2UgOiB0cnVlLFxyXG5cdCBcdHJlcGxhY2UgOiB0cnVlXHJcblx0IH0pO1xyXG5cclxuXHQvKipcclxuXHQgKiBwb3BzdGF0ZSBldmVudFxyXG5cdCAqL1xyXG5cdCB3aW5kb3cub25wb3BzdGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KXtcclxuXHQgXHRuZXcgU3RhdGlvKHtcclxuXHQgXHRcdHVybCA6IGxvY2F0aW9uLmhyZWYsXHJcblx0IFx0XHRyZXBsYWNlIDogdHJ1ZVxyXG5cdCBcdH0pO1xyXG5cdCB9O1xyXG59KSgpOyIsIlxyXG4vLyBDb3B5cmlnaHQgMjAxMy0yMDE0IEtldmluIENveFxyXG5cclxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgVGhpcyBzb2Z0d2FyZSBpcyBwcm92aWRlZCAnYXMtaXMnLCB3aXRob3V0IGFueSBleHByZXNzIG9yIGltcGxpZWQgICAgICAgICAgICpcclxuKiAgd2FycmFudHkuIEluIG5vIGV2ZW50IHdpbGwgdGhlIGF1dGhvcnMgYmUgaGVsZCBsaWFibGUgZm9yIGFueSBkYW1hZ2VzICAgICAgICpcclxuKiAgYXJpc2luZyBmcm9tIHRoZSB1c2Ugb2YgdGhpcyBzb2Z0d2FyZS4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgUGVybWlzc2lvbiBpcyBncmFudGVkIHRvIGFueW9uZSB0byB1c2UgdGhpcyBzb2Z0d2FyZSBmb3IgYW55IHB1cnBvc2UsICAgICAgICpcclxuKiAgaW5jbHVkaW5nIGNvbW1lcmNpYWwgYXBwbGljYXRpb25zLCBhbmQgdG8gYWx0ZXIgaXQgYW5kIHJlZGlzdHJpYnV0ZSBpdCAgICAgICpcclxuKiAgZnJlZWx5LCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgcmVzdHJpY3Rpb25zOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgMS4gVGhlIG9yaWdpbiBvZiB0aGlzIHNvZnR3YXJlIG11c3Qgbm90IGJlIG1pc3JlcHJlc2VudGVkOyB5b3UgbXVzdCBub3QgICAgICpcclxuKiAgICAgY2xhaW0gdGhhdCB5b3Ugd3JvdGUgdGhlIG9yaWdpbmFsIHNvZnR3YXJlLiBJZiB5b3UgdXNlIHRoaXMgc29mdHdhcmUgaW4gICpcclxuKiAgICAgYSBwcm9kdWN0LCBhbiBhY2tub3dsZWRnbWVudCBpbiB0aGUgcHJvZHVjdCBkb2N1bWVudGF0aW9uIHdvdWxkIGJlICAgICAgICpcclxuKiAgICAgYXBwcmVjaWF0ZWQgYnV0IGlzIG5vdCByZXF1aXJlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgMi4gQWx0ZXJlZCBzb3VyY2UgdmVyc2lvbnMgbXVzdCBiZSBwbGFpbmx5IG1hcmtlZCBhcyBzdWNoLCBhbmQgbXVzdCBub3QgYmUgICpcclxuKiAgICAgbWlzcmVwcmVzZW50ZWQgYXMgYmVpbmcgdGhlIG9yaWdpbmFsIHNvZnR3YXJlLiAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKiAgMy4gVGhpcyBub3RpY2UgbWF5IG5vdCBiZSByZW1vdmVkIG9yIGFsdGVyZWQgZnJvbSBhbnkgc291cmNlIGRpc3RyaWJ1dGlvbi4gICpcclxuKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbitmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBhcnJheSA9IC9cXFsoW15cXFtdKilcXF0kLztcclxuXHJcbi8vLyBVUkwgUmVnZXguXHJcbi8qKlxyXG4gKiBUaGlzIHJlZ2V4IHNwbGl0cyB0aGUgVVJMIGludG8gcGFydHMuICBUaGUgY2FwdHVyZSBncm91cHMgY2F0Y2ggdGhlIGltcG9ydGFudFxyXG4gKiBiaXRzLlxyXG4gKlxyXG4gKiBFYWNoIHNlY3Rpb24gaXMgb3B0aW9uYWwsIHNvIHRvIHdvcmsgb24gYW55IHBhcnQgZmluZCB0aGUgY29ycmVjdCB0b3AgbGV2ZWxcclxuICogYCguLi4pP2AgYW5kIG1lc3MgYXJvdW5kIHdpdGggaXQuXHJcbiAqL1xyXG52YXIgcmVnZXggPSAvXig/OihbYS16XSopOik/KD86XFwvXFwvKT8oPzooW146QF0qKSg/OjooW15AXSopKT9AKT8oWzAtOWEtei0uX10rKT8oPzo6KFswLTldKikpPyhcXC9bXj8jXSopPyg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8kL2k7XHJcbi8vICAgICAgICAgICAgICAgMSAtIHNjaGVtZSAgICAgICAgICAgICAgMiAtIHVzZXIgICAgMyA9IHBhc3MgICAgNCAtIGhvc3QgICAgICAgICAgIDUgLSBwb3J0ICA2IC0gcGF0aCAgICAgICAgNyAtIHF1ZXJ5ICAgIDggLSBoYXNoXHJcblxyXG52YXIgbm9zbGFzaCA9IFtcIm1haWx0b1wiLFwiYml0Y29pblwiXTtcclxuXHJcbnZhciBzZWxmID0ge1xyXG5cdC8qKiBQYXJzZSBhIHF1ZXJ5IHN0cmluZy5cclxuXHQgKlxyXG5cdCAqIFRoaXMgZnVuY3Rpb24gcGFyc2VzIGEgcXVlcnkgc3RyaW5nIChzb21ldGltZXMgY2FsbGVkIHRoZSBzZWFyY2hcclxuXHQgKiBzdHJpbmcpLiAgSXQgdGFrZXMgYSBxdWVyeSBzdHJpbmcgYW5kIHJldHVybnMgYSBtYXAgb2YgdGhlIHJlc3VsdHMuXHJcblx0ICpcclxuXHQgKiBLZXlzIGFyZSBjb25zaWRlcmVkIHRvIGJlIGV2ZXJ5dGhpbmcgdXAgdG8gdGhlIGZpcnN0ICc9JyBhbmQgdmFsdWVzIGFyZVxyXG5cdCAqIGV2ZXJ5dGhpbmcgYWZ0ZXJ3b3Jkcy4gIFNpbmNlIFVSTC1kZWNvZGluZyBpcyBkb25lIGFmdGVyIHBhcnNpbmcsIGtleXNcclxuXHQgKiBhbmQgdmFsdWVzIGNhbiBoYXZlIGFueSB2YWx1ZXMsIGhvd2V2ZXIsICc9JyBoYXZlIHRvIGJlIGVuY29kZWQgaW4ga2V5c1xyXG5cdCAqIHdoaWxlICc/JyBhbmQgJyYnIGhhdmUgdG8gYmUgZW5jb2RlZCBhbnl3aGVyZSAoYXMgdGhleSBkZWxpbWl0IHRoZVxyXG5cdCAqIGt2LXBhaXJzKS5cclxuXHQgKlxyXG5cdCAqIEtleXMgYW5kIHZhbHVlcyB3aWxsIGFsd2F5cyBiZSBzdHJpbmdzLCBleGNlcHQgaWYgdGhlcmUgaXMgYSBrZXkgd2l0aCBub1xyXG5cdCAqICc9JyBpbiB3aGljaCBjYXNlIGl0IHdpbGwgYmUgY29uc2lkZXJlZCBhIGZsYWcgYW5kIHdpbGwgYmUgc2V0IHRvIHRydWUuXHJcblx0ICogTGF0ZXIgdmFsdWVzIHdpbGwgb3ZlcnJpZGUgZWFybGllciB2YWx1ZXMuXHJcblx0ICpcclxuXHQgKiBBcnJheSBrZXlzIGFyZSBhbHNvIHN1cHBvcnRlZC4gIEJ5IGRlZmF1bHQga2V5cyBpbiB0aGUgZm9ybSBvZiBgbmFtZVtpXWBcclxuXHQgKiB3aWxsIGJlIHJldHVybmVkIGxpa2UgdGhhdCBhcyBzdHJpbmdzLiAgSG93ZXZlciwgaWYgeW91IHNldCB0aGUgYGFycmF5YFxyXG5cdCAqIGZsYWcgaW4gdGhlIG9wdGlvbnMgb2JqZWN0IHRoZXkgd2lsbCBiZSBwYXJzZWQgaW50byBhcnJheXMuICBOb3RlIHRoYXRcclxuXHQgKiBhbHRob3VnaCB0aGUgb2JqZWN0IHJldHVybmVkIGlzIGFuIGBBcnJheWAgb2JqZWN0IGFsbCBrZXlzIHdpbGwgYmVcclxuXHQgKiB3cml0dGVuIHRvIGl0LiAgVGhpcyBtZWFucyB0aGF0IGlmIHlvdSBoYXZlIGEga2V5IHN1Y2ggYXMgYGtbZm9yRWFjaF1gXHJcblx0ICogaXQgd2lsbCBvdmVyd3JpdGUgdGhlIGBmb3JFYWNoYCBmdW5jdGlvbiBvbiB0aGF0IGFycmF5LiAgQWxzbyBub3RlIHRoYXRcclxuXHQgKiBzdHJpbmcgcHJvcGVydGllcyBhbHdheXMgdGFrZSBwcmVjZWRlbmNlIG92ZXIgYXJyYXkgcHJvcGVydGllcyxcclxuXHQgKiBpcnJlc3BlY3RpdmUgb2Ygd2hlcmUgdGhleSBhcmUgaW4gdGhlIHF1ZXJ5IHN0cmluZy5cclxuXHQgKlxyXG5cdCAqICAgdXJsLmdldChcImFycmF5WzFdPXRlc3QmYXJyYXlbZm9vXT1iYXJcIix7YXJyYXk6dHJ1ZX0pLmFycmF5WzFdICA9PT0gXCJ0ZXN0XCJcclxuXHQgKiAgIHVybC5nZXQoXCJhcnJheVsxXT10ZXN0JmFycmF5W2Zvb109YmFyXCIse2FycmF5OnRydWV9KS5hcnJheS5mb28gPT09IFwiYmFyXCJcclxuXHQgKiAgIHVybC5nZXQoXCJhcnJheT1ub3RhbmFycmF5JmFycmF5WzBdPTFcIix7YXJyYXk6dHJ1ZX0pLmFycmF5ICAgICAgPT09IFwibm90YW5hcnJheVwiXHJcblx0ICpcclxuXHQgKiBJZiBhcnJheSBwYXJzaW5nIGlzIGVuYWJsZWQga2V5cyBpbiB0aGUgZm9ybSBvZiBgbmFtZVtdYCB3aWxsXHJcblx0ICogYXV0b21hdGljYWxseSBiZSBnaXZlbiB0aGUgbmV4dCBhdmFpbGFibGUgaW5kZXguICBOb3RlIHRoYXQgdGhpcyBjYW4gYmVcclxuXHQgKiBvdmVyd3JpdHRlbiB3aXRoIGxhdGVyIHZhbHVlcyBpbiB0aGUgcXVlcnkgc3RyaW5nLiAgRm9yIHRoaXMgcmVhc29uIGlzXHJcblx0ICogaXMgYmVzdCBub3QgdG8gbWl4IHRoZSB0d28gZm9ybWF0cywgYWx0aG91Z2ggaXQgaXMgc2FmZSAoYW5kIG9mdGVuXHJcblx0ICogdXNlZnVsKSB0byBhZGQgYW4gYXV0b21hdGljIGluZGV4IGFyZ3VtZW50IHRvIHRoZSBlbmQgb2YgYSBxdWVyeSBzdHJpbmcuXHJcblx0ICpcclxuXHQgKiAgIHVybC5nZXQoXCJhW109MCZhW109MSZhWzBdPTJcIiwge2FycmF5OnRydWV9KSAgLT4ge2E6W1wiMlwiLFwiMVwiXX07XHJcblx0ICogICB1cmwuZ2V0KFwiYVswXT0wJmFbMV09MSZhW109MlwiLCB7YXJyYXk6dHJ1ZX0pIC0+IHthOltcIjBcIixcIjFcIixcIjJcIl19O1xyXG5cdCAqXHJcblx0ICogQHBhcmFte3N0cmluZ30gcSBUaGUgcXVlcnkgc3RyaW5nICh0aGUgcGFydCBhZnRlciB0aGUgJz8nKS5cclxuXHQgKiBAcGFyYW17e2Z1bGw6Ym9vbGVhbixhcnJheTpib29sZWFufT19IG9wdCBPcHRpb25zLlxyXG5cdCAqXHJcblx0ICogLSBmdWxsOiBJZiBzZXQgYHFgIHdpbGwgYmUgdHJlYXRlZCBhcyBhIGZ1bGwgdXJsIGFuZCBgcWAgd2lsbCBiZSBidWlsdC5cclxuXHQgKiAgIGJ5IGNhbGxpbmcgI3BhcnNlIHRvIHJldHJpZXZlIHRoZSBxdWVyeSBwb3J0aW9uLlxyXG5cdCAqIC0gYXJyYXk6IElmIHNldCBrZXlzIGluIHRoZSBmb3JtIG9mIGBrZXlbaV1gIHdpbGwgYmUgdHJlYXRlZFxyXG5cdCAqICAgYXMgYXJyYXlzL21hcHMuXHJcblx0ICpcclxuXHQgKiBAcmV0dXJueyFPYmplY3QuPHN0cmluZywgc3RyaW5nfEFycmF5Pn0gVGhlIHBhcnNlZCByZXN1bHQuXHJcblx0ICovXHJcblx0XCJnZXRcIjogZnVuY3Rpb24ocSwgb3B0KXtcclxuXHRcdHEgPSBxIHx8IFwiXCI7XHJcblx0XHRpZiAoIHR5cGVvZiBvcHQgICAgICAgICAgPT0gXCJ1bmRlZmluZWRcIiApIG9wdCA9IHt9O1xyXG5cdFx0aWYgKCB0eXBlb2Ygb3B0W1wiZnVsbFwiXSAgPT0gXCJ1bmRlZmluZWRcIiApIG9wdFtcImZ1bGxcIl0gPSBmYWxzZTtcclxuXHRcdGlmICggdHlwZW9mIG9wdFtcImFycmF5XCJdID09IFwidW5kZWZpbmVkXCIgKSBvcHRbXCJhcnJheVwiXSA9IGZhbHNlO1xyXG5cclxuXHRcdGlmICggb3B0W1wiZnVsbFwiXSA9PT0gdHJ1ZSApXHJcblx0XHR7XHJcblx0XHRcdHEgPSBzZWxmW1wicGFyc2VcIl0ocSwge1wiZ2V0XCI6ZmFsc2V9KVtcInF1ZXJ5XCJdIHx8IFwiXCI7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIG8gPSB7fTtcclxuXHJcblx0XHR2YXIgYyA9IHEuc3BsaXQoXCImXCIpO1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjLmxlbmd0aDsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHRpZiAoIWNbaV0ubGVuZ3RoKSBjb250aW51ZTtcclxuXHJcblx0XHRcdHZhciBkID0gY1tpXS5pbmRleE9mKFwiPVwiKTtcclxuXHRcdFx0dmFyIGsgPSBjW2ldLCB2ID0gdHJ1ZTtcclxuXHRcdFx0aWYgKCBkID49IDAgKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0ayA9IGNbaV0uc3Vic3RyKDAsIGQpO1xyXG5cdFx0XHRcdHYgPSBjW2ldLnN1YnN0cihkKzEpO1xyXG5cclxuXHRcdFx0XHR2ID0gZGVjb2RlVVJJQ29tcG9uZW50KHYpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAob3B0W1wiYXJyYXlcIl0pXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgaW5kcyA9IFtdO1xyXG5cdFx0XHRcdHZhciBpbmQ7XHJcblx0XHRcdFx0dmFyIGN1cm8gPSBvO1xyXG5cdFx0XHRcdHZhciBjdXJrID0gaztcclxuXHRcdFx0XHR3aGlsZSAoaW5kID0gY3Vyay5tYXRjaChhcnJheSkpIC8vIEFycmF5IVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGN1cmsgPSBjdXJrLnN1YnN0cigwLCBpbmQuaW5kZXgpO1xyXG5cdFx0XHRcdFx0aW5kcy51bnNoaWZ0KGRlY29kZVVSSUNvbXBvbmVudChpbmRbMV0pKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y3VyayA9IGRlY29kZVVSSUNvbXBvbmVudChjdXJrKTtcclxuXHRcdFx0XHRpZiAoaW5kcy5zb21lKGZ1bmN0aW9uKGkpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0aWYgKCB0eXBlb2YgY3Vyb1tjdXJrXSA9PSBcInVuZGVmaW5lZFwiICkgY3Vyb1tjdXJrXSA9IFtdO1xyXG5cdFx0XHRcdFx0aWYgKCFBcnJheS5pc0FycmF5KGN1cm9bY3Vya10pKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwidXJsLmdldDogQXJyYXkgcHJvcGVydHkgXCIrY3VyaytcIiBhbHJlYWR5IGV4aXN0cyBhcyBzdHJpbmchXCIpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRjdXJvID0gY3Vyb1tjdXJrXTtcclxuXHJcblx0XHRcdFx0XHRpZiAoIGkgPT09IFwiXCIgKSBpID0gY3Vyby5sZW5ndGg7XHJcblxyXG5cdFx0XHRcdFx0Y3VyayA9IGk7XHJcblx0XHRcdFx0fSkpIGNvbnRpbnVlO1xyXG5cdFx0XHRcdGN1cm9bY3Vya10gPSB2O1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRrID0gZGVjb2RlVVJJQ29tcG9uZW50KGspO1xyXG5cclxuXHRcdFx0Ly90eXBlb2Ygb1trXSA9PSBcInVuZGVmaW5lZFwiIHx8IGNvbnNvbGUubG9nKFwiUHJvcGVydHkgXCIraytcIiBhbHJlYWR5IGV4aXN0cyFcIik7XHJcblx0XHRcdG9ba10gPSB2O1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBvO1xyXG5cdH0sXHJcblxyXG5cdC8qKiBCdWlsZCBhIGdldCBxdWVyeSBmcm9tIGFuIG9iamVjdC5cclxuXHQgKlxyXG5cdCAqIFRoaXMgY29uc3RydWN0cyBhIHF1ZXJ5IHN0cmluZyBmcm9tIHRoZSBrdiBwYWlycyBpbiBgZGF0YWAuICBDYWxsaW5nXHJcblx0ICogI2dldCBvbiB0aGUgc3RyaW5nIHJldHVybmVkIHNob3VsZCByZXR1cm4gYW4gb2JqZWN0IGlkZW50aWNhbCB0byB0aGUgb25lXHJcblx0ICogcGFzc2VkIGluIGV4Y2VwdCBhbGwgbm9uLWJvb2xlYW4gc2NhbGFyIHR5cGVzIGJlY29tZSBzdHJpbmdzIGFuZCBhbGxcclxuXHQgKiBvYmplY3QgdHlwZXMgYmVjb21lIGFycmF5cyAobm9uLWludGVnZXIga2V5cyBhcmUgc3RpbGwgcHJlc2VudCwgc2VlXHJcblx0ICogI2dldCdzIGRvY3VtZW50YXRpb24gZm9yIG1vcmUgZGV0YWlscykuXHJcblx0ICpcclxuXHQgKiBUaGlzIGFsd2F5cyB1c2VzIGFycmF5IHN5bnRheCBmb3IgZGVzY3JpYmluZyBhcnJheXMuICBJZiB5b3Ugd2FudCB0b1xyXG5cdCAqIHNlcmlhbGl6ZSB0aGVtIGRpZmZlcmVudGx5IChsaWtlIGhhdmluZyB0aGUgdmFsdWUgYmUgYSBKU09OIGFycmF5IGFuZFxyXG5cdCAqIGhhdmUgYSBwbGFpbiBrZXkpIHlvdSB3aWxsIG5lZWQgdG8gZG8gdGhhdCBiZWZvcmUgcGFzc2luZyBpdCBpbi5cclxuXHQgKlxyXG5cdCAqIEFsbCBrZXlzIGFuZCB2YWx1ZXMgYXJlIHN1cHBvcnRlZCAoYmluYXJ5IGRhdGEgYW55b25lPykgYXMgdGhleSBhcmVcclxuXHQgKiBwcm9wZXJseSBVUkwtZW5jb2RlZCBhbmQgI2dldCBwcm9wZXJseSBkZWNvZGVzLlxyXG5cdCAqXHJcblx0ICogQHBhcmFte09iamVjdH0gZGF0YSBUaGUga3YgcGFpcnMuXHJcblx0ICogQHBhcmFte3N0cmluZ30gcHJlZml4IFRoZSBwcm9wZXJseSBlbmNvZGVkIGFycmF5IGtleSB0byBwdXQgdGhlXHJcblx0ICogICBwcm9wZXJ0aWVzLiAgTWFpbmx5IGludGVuZGVkIGZvciBpbnRlcm5hbCB1c2UuXHJcblx0ICogQHJldHVybntzdHJpbmd9IEEgVVJMLXNhZmUgc3RyaW5nLlxyXG5cdCAqL1xyXG5cdFwiYnVpbGRnZXRcIjogZnVuY3Rpb24oZGF0YSwgcHJlZml4KXtcclxuXHRcdHZhciBpdG1zID0gW107XHJcblx0XHRmb3IgKCB2YXIgayBpbiBkYXRhIClcclxuXHRcdHtcclxuXHRcdFx0dmFyIGVrID0gZW5jb2RlVVJJQ29tcG9uZW50KGspO1xyXG5cdFx0XHRpZiAoIHR5cGVvZiBwcmVmaXggIT0gXCJ1bmRlZmluZWRcIiApXHJcblx0XHRcdFx0ZWsgPSBwcmVmaXgrXCJbXCIrZWsrXCJdXCI7XHJcblxyXG5cdFx0XHR2YXIgdiA9IGRhdGFba107XHJcblxyXG5cdFx0XHRzd2l0Y2ggKHR5cGVvZiB2KVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y2FzZSAnYm9vbGVhbic6XHJcblx0XHRcdFx0XHRpZih2KSBpdG1zLnB1c2goZWspO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnbnVtYmVyJzpcclxuXHRcdFx0XHRcdHYgPSB2LnRvU3RyaW5nKCk7XHJcblx0XHRcdFx0Y2FzZSAnc3RyaW5nJzpcclxuXHRcdFx0XHRcdGl0bXMucHVzaChlaytcIj1cIitlbmNvZGVVUklDb21wb25lbnQodikpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAnb2JqZWN0JzpcclxuXHRcdFx0XHRcdGl0bXMucHVzaChzZWxmW1wiYnVpbGRnZXRcIl0odiwgZWspKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gaXRtcy5qb2luKFwiJlwiKTtcclxuXHR9LFxyXG5cclxuXHQvKiogUGFyc2UgYSBVUkxcclxuXHQgKlxyXG5cdCAqIFRoaXMgYnJlYWtzIHVwIGEgVVJMIGludG8gY29tcG9uZW50cy4gIEl0IGF0dGVtcHRzIHRvIGJlIHZlcnkgbGliZXJhbFxyXG5cdCAqIGFuZCByZXR1cm5zIHRoZSBiZXN0IHJlc3VsdCBpbiBtb3N0IGNhc2VzLiAgVGhpcyBtZWFucyB0aGF0IHlvdSBjYW5cclxuXHQgKiBvZnRlbiBwYXNzIGluIHBhcnQgb2YgYSBVUkwgYW5kIGdldCBjb3JyZWN0IGNhdGVnb3JpZXMgYmFjay4gIE5vdGFibHksXHJcblx0ICogdGhpcyB3b3JrcyBmb3IgZW1haWxzIGFuZCBKYWJiZXIgSURzLCBhcyB3ZWxsIGFzIGFkZGluZyBhICc/JyB0byB0aGVcclxuXHQgKiBiZWdpbm5pbmcgb2YgYSBzdHJpbmcgd2lsbCBwYXJzZSB0aGUgd2hvbGUgdGhpbmcgYXMgYSBxdWVyeSBzdHJpbmcuICBJZlxyXG5cdCAqIGFuIGl0ZW0gaXMgbm90IGZvdW5kIHRoZSBwcm9wZXJ0eSB3aWxsIGJlIHVuZGVmaW5lZC4gIEluIHNvbWUgY2FzZXMgYW5cclxuXHQgKiBlbXB0eSBzdHJpbmcgd2lsbCBiZSByZXR1cm5lZCBpZiB0aGUgc3Vycm91bmRpbmcgc3ludGF4IGJ1dCB0aGUgYWN0dWFsXHJcblx0ICogdmFsdWUgaXMgZW1wdHkgKGV4YW1wbGU6IFwiOi8vZXhhbXBsZS5jb21cIiB3aWxsIGdpdmUgYSBlbXB0eSBzdHJpbmcgZm9yXHJcblx0ICogc2NoZW1lLikgIE5vdGFibHkgdGhlIGhvc3QgbmFtZSB3aWxsIGFsd2F5cyBiZSBzZXQgdG8gc29tZXRoaW5nLlxyXG5cdCAqXHJcblx0ICogUmV0dXJuZWQgcHJvcGVydGllcy5cclxuXHQgKlxyXG5cdCAqIC0gKipzY2hlbWU6KiogVGhlIHVybCBzY2hlbWUuIChleDogXCJtYWlsdG9cIiBvciBcImh0dHBzXCIpXHJcblx0ICogLSAqKnVzZXI6KiogVGhlIHVzZXJuYW1lLlxyXG5cdCAqIC0gKipwYXNzOioqIFRoZSBwYXNzd29yZC5cclxuXHQgKiAtICoqaG9zdDoqKiBUaGUgaG9zdG5hbWUuIChleDogXCJsb2NhbGhvc3RcIiwgXCIxMjMuNDU2LjcuOFwiIG9yIFwiZXhhbXBsZS5jb21cIilcclxuXHQgKiAtICoqcG9ydDoqKiBUaGUgcG9ydCwgYXMgYSBudW1iZXIuIChleDogMTMzNylcclxuXHQgKiAtICoqcGF0aDoqKiBUaGUgcGF0aC4gKGV4OiBcIi9cIiBvciBcIi9hYm91dC5odG1sXCIpXHJcblx0ICogLSAqKnF1ZXJ5OioqIFwiVGhlIHF1ZXJ5IHN0cmluZy4gKGV4OiBcImZvbz1iYXImdj0xNyZmb3JtYXQ9anNvblwiKVxyXG5cdCAqIC0gKipnZXQ6KiogVGhlIHF1ZXJ5IHN0cmluZyBwYXJzZWQgd2l0aCBnZXQuICBJZiBgb3B0LmdldGAgaXMgYGZhbHNlYCB0aGlzXHJcblx0ICogICB3aWxsIGJlIGFic2VudFxyXG5cdCAqIC0gKipoYXNoOioqIFRoZSB2YWx1ZSBhZnRlciB0aGUgaGFzaC4gKGV4OiBcIm15YW5jaG9yXCIpXHJcblx0ICogICBiZSB1bmRlZmluZWQgZXZlbiBpZiBgcXVlcnlgIGlzIHNldC5cclxuXHQgKlxyXG5cdCAqIEBwYXJhbXtzdHJpbmd9IHVybCBUaGUgVVJMIHRvIHBhcnNlLlxyXG5cdCAqIEBwYXJhbXt7Z2V0Ok9iamVjdH09fSBvcHQgT3B0aW9uczpcclxuXHQgKlxyXG5cdCAqIC0gZ2V0OiBBbiBvcHRpb25zIGFyZ3VtZW50IHRvIGJlIHBhc3NlZCB0byAjZ2V0IG9yIGZhbHNlIHRvIG5vdCBjYWxsICNnZXQuXHJcblx0ICogICAgKipETyBOT1QqKiBzZXQgYGZ1bGxgLlxyXG5cdCAqXHJcblx0ICogQHJldHVybnshT2JqZWN0fSBBbiBvYmplY3Qgd2l0aCB0aGUgcGFyc2VkIHZhbHVlcy5cclxuXHQgKi9cclxuXHRcInBhcnNlXCI6IGZ1bmN0aW9uKHVybCwgb3B0KSB7XHJcblxyXG5cdFx0aWYgKCB0eXBlb2Ygb3B0ID09IFwidW5kZWZpbmVkXCIgKSBvcHQgPSB7fTtcclxuXHJcblx0XHR2YXIgbWQgPSB1cmwubWF0Y2gocmVnZXgpIHx8IFtdO1xyXG5cclxuXHRcdHZhciByID0ge1xyXG5cdFx0XHRcInVybFwiOiAgICB1cmwsXHJcblxyXG5cdFx0XHRcInNjaGVtZVwiOiBtZFsxXSxcclxuXHRcdFx0XCJ1c2VyXCI6ICAgbWRbMl0sXHJcblx0XHRcdFwicGFzc1wiOiAgIG1kWzNdLFxyXG5cdFx0XHRcImhvc3RcIjogICBtZFs0XSxcclxuXHRcdFx0XCJwb3J0XCI6ICAgbWRbNV0gJiYgK21kWzVdLFxyXG5cdFx0XHRcInBhdGhcIjogICBtZFs2XSxcclxuXHRcdFx0XCJxdWVyeVwiOiAgbWRbN10sXHJcblx0XHRcdFwiaGFzaFwiOiAgIG1kWzhdLFxyXG5cdFx0fTtcclxuXHJcblx0XHRpZiAoIG9wdC5nZXQgIT09IGZhbHNlIClcclxuXHRcdFx0cltcImdldFwiXSA9IHJbXCJxdWVyeVwiXSAmJiBzZWxmW1wiZ2V0XCJdKHJbXCJxdWVyeVwiXSwgb3B0LmdldCk7XHJcblxyXG5cdFx0cmV0dXJuIHI7XHJcblx0fSxcclxuXHJcblx0LyoqIEJ1aWxkIGEgVVJMIGZyb20gY29tcG9uZW50cy5cclxuXHQgKlxyXG5cdCAqIFRoaXMgcGllY2VzIHRvZ2V0aGVyIGEgdXJsIGZyb20gdGhlIHByb3BlcnRpZXMgb2YgdGhlIHBhc3NlZCBpbiBvYmplY3QuXHJcblx0ICogSW4gZ2VuZXJhbCBwYXNzaW5nIHRoZSByZXN1bHQgb2YgYHBhcnNlKClgIHNob3VsZCByZXR1cm4gdGhlIFVSTC4gIFRoZXJlXHJcblx0ICogbWF5IGRpZmZlcmVuY2VzIGluIHRoZSBnZXQgc3RyaW5nIGFzIHRoZSBrZXlzIGFuZCB2YWx1ZXMgbWlnaHQgYmUgbW9yZVxyXG5cdCAqIGVuY29kZWQgdGhlbiB0aGV5IHdlcmUgb3JpZ2luYWxseSB3ZXJlLiAgSG93ZXZlciwgY2FsbGluZyBgZ2V0KClgIG9uIHRoZVxyXG5cdCAqIHR3byB2YWx1ZXMgc2hvdWxkIHlpZWxkIHRoZSBzYW1lIHJlc3VsdC5cclxuXHQgKlxyXG5cdCAqIEhlcmUgaXMgaG93IHRoZSBwYXJhbWV0ZXJzIGFyZSB1c2VkLlxyXG5cdCAqXHJcblx0ICogIC0gdXJsOiBVc2VkIG9ubHkgaWYgbm8gb3RoZXIgdmFsdWVzIGFyZSBwcm92aWRlZC4gIElmIHRoYXQgaXMgdGhlIGNhc2VcclxuXHQgKiAgICAgYHVybGAgd2lsbCBiZSByZXR1cm5lZCB2ZXJiYXRpbS5cclxuXHQgKiAgLSBzY2hlbWU6IFVzZWQgaWYgZGVmaW5lZC5cclxuXHQgKiAgLSB1c2VyOiBVc2VkIGlmIGRlZmluZWQuXHJcblx0ICogIC0gcGFzczogVXNlZCBpZiBkZWZpbmVkLlxyXG5cdCAqICAtIGhvc3Q6IFVzZWQgaWYgZGVmaW5lZC5cclxuXHQgKiAgLSBwYXRoOiBVc2VkIGlmIGRlZmluZWQuXHJcblx0ICogIC0gcXVlcnk6IFVzZWQgb25seSBpZiBgZ2V0YCBpcyBub3QgcHJvdmlkZWQgYW5kIG5vbi1lbXB0eS5cclxuXHQgKiAgLSBnZXQ6IFVzZWQgaWYgbm9uLWVtcHR5LiAgUGFzc2VkIHRvICNidWlsZGdldCBhbmQgdGhlIHJlc3VsdCBpcyB1c2VkXHJcblx0ICogICAgYXMgdGhlIHF1ZXJ5IHN0cmluZy5cclxuXHQgKiAgLSBoYXNoOiBVc2VkIGlmIGRlZmluZWQuXHJcblx0ICpcclxuXHQgKiBUaGVzZSBhcmUgdGhlIG9wdGlvbnMgdGhhdCBhcmUgdmFsaWQgb24gdGhlIG9wdGlvbnMgb2JqZWN0LlxyXG5cdCAqXHJcblx0ICogIC0gdXNlZW1wdHlnZXQ6IElmIHRydXRoeSwgYSBxdWVzdGlvbiBtYXJrIHdpbGwgYmUgYXBwZW5kZWQgZm9yIGVtcHR5IGdldFxyXG5cdCAqICAgIHN0cmluZ3MuICBUaGlzIG5vdGFibHkgbWFrZXMgYGJ1aWxkKClgIGFuZCBgcGFyc2UoKWAgZnVsbHkgc3ltbWV0cmljLlxyXG5cdCAqXHJcblx0ICogQHBhcmFte09iamVjdH0gZGF0YSBUaGUgcGllY2VzIG9mIHRoZSBVUkwuXHJcblx0ICogQHBhcmFte09iamVjdH0gb3B0IE9wdGlvbnMgZm9yIGJ1aWxkaW5nIHRoZSB1cmwuXHJcblx0ICogQHJldHVybntzdHJpbmd9IFRoZSBVUkwuXHJcblx0ICovXHJcblx0XCJidWlsZFwiOiBmdW5jdGlvbihkYXRhLCBvcHQpe1xyXG5cdFx0b3B0ID0gb3B0IHx8IHt9O1xyXG5cclxuXHRcdHZhciByID0gXCJcIjtcclxuXHJcblx0XHRpZiAoIHR5cGVvZiBkYXRhW1wic2NoZW1lXCJdICE9IFwidW5kZWZpbmVkXCIgKVxyXG5cdFx0e1xyXG5cdFx0XHRyICs9IGRhdGFbXCJzY2hlbWVcIl07XHJcblx0XHRcdHIgKz0gKG5vc2xhc2guaW5kZXhPZihkYXRhW1wic2NoZW1lXCJdKT49MCk/XCI6XCI6XCI6Ly9cIjtcclxuXHRcdH1cclxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJ1c2VyXCJdICE9IFwidW5kZWZpbmVkXCIgKVxyXG5cdFx0e1xyXG5cdFx0XHRyICs9IGRhdGFbXCJ1c2VyXCJdO1xyXG5cdFx0XHRpZiAoIHR5cGVvZiBkYXRhW1wicGFzc1wiXSA9PSBcInVuZGVmaW5lZFwiIClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHIgKz0gXCJAXCI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJwYXNzXCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IFwiOlwiICsgZGF0YVtcInBhc3NcIl0gKyBcIkBcIjtcclxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJob3N0XCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IGRhdGFbXCJob3N0XCJdO1xyXG5cdFx0aWYgKCB0eXBlb2YgZGF0YVtcInBvcnRcIl0gIT0gXCJ1bmRlZmluZWRcIiApIHIgKz0gXCI6XCIgKyBkYXRhW1wicG9ydFwiXTtcclxuXHRcdGlmICggdHlwZW9mIGRhdGFbXCJwYXRoXCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IGRhdGFbXCJwYXRoXCJdO1xyXG5cclxuXHRcdGlmIChvcHRbXCJ1c2VlbXB0eWdldFwiXSlcclxuXHRcdHtcclxuXHRcdFx0aWYgICAgICAoIHR5cGVvZiBkYXRhW1wiZ2V0XCJdICAgIT0gXCJ1bmRlZmluZWRcIiApIHIgKz0gXCI/XCIgKyBzZWxmW1wiYnVpbGRnZXRcIl0oZGF0YVtcImdldFwiXSk7XHJcblx0XHRcdGVsc2UgaWYgKCB0eXBlb2YgZGF0YVtcInF1ZXJ5XCJdICE9IFwidW5kZWZpbmVkXCIgKSByICs9IFwiP1wiICsgZGF0YVtcInF1ZXJ5XCJdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZVxyXG5cdFx0e1xyXG5cdFx0XHQvLyBJZiAuZ2V0IHVzZSBpdC4gIElmIC5nZXQgbGVhZHMgdG8gZW1wdHksIHVzZSAucXVlcnkuXHJcblx0XHRcdHZhciBxID0gZGF0YVtcImdldFwiXSAmJiBzZWxmW1wiYnVpbGRnZXRcIl0oZGF0YVtcImdldFwiXSkgfHwgZGF0YVtcInF1ZXJ5XCJdO1xyXG5cdFx0XHRpZiAocSkgciArPSBcIj9cIiArIHE7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCB0eXBlb2YgZGF0YVtcImhhc2hcIl0gIT0gXCJ1bmRlZmluZWRcIiApIHIgKz0gXCIjXCIgKyBkYXRhW1wiaGFzaFwiXTtcclxuXHJcblx0XHRyZXR1cm4gciB8fCBkYXRhW1widXJsXCJdIHx8IFwiXCI7XHJcblx0fSxcclxufTtcclxuXHJcbmlmICggdHlwZW9mIGRlZmluZSAhPSBcInVuZGVmaW5lZFwiICYmIGRlZmluZVtcImFtZFwiXSApIGRlZmluZShzZWxmKTtcclxuZWxzZSBpZiAoIHR5cGVvZiBtb2R1bGUgIT0gXCJ1bmRlZmluZWRcIiApIG1vZHVsZVsnZXhwb3J0cyddID0gc2VsZjtcclxuZWxzZSB3aW5kb3dbXCJ1cmxcIl0gPSBzZWxmO1xyXG5cclxufSgpOyIsIihmdW5jdGlvbiAoKSB7XHJcblx0ZnVuY3Rpb24gVml3RmlsZSgpXHJcblx0e1xyXG5cdFx0JCgnLmN1c3RvbS1maWxlLWlucHV0JywgdGhpcykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCl7XHJcblx0XHRcdGlmICghd2luZG93LkZpbGUgJiYgIXdpbmRvdy5GaWxlUmVhZGVyICYmICF3aW5kb3cuRmlsZUxpc3QgJiYgIXdpbmRvdy5CbG9iKSB7XHJcblx0XHRcdFx0Y29uc29sZS5lcnJvcignRmlsZVJlYWRlciB1bnN1cHBvcnRlZCEnKTtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIGZpbGVfaW5kZXggPSAwO1xyXG5cdFx0XHR2YXIgZmlsZTtcclxuXHRcdFx0JCh0aGlzKS5uZXh0KCkuaHRtbCgnJyk7XHJcblx0XHRcdHZhciBmaWxlcyA9IFtdO1xyXG5cdFx0XHR3aGlsZSAoZmlsZSA9IHRoaXMuZmlsZXMuaXRlbShmaWxlX2luZGV4KyspKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0ZmlsZXMucHVzaChmaWxlLm5hbWUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdCQodGhpcykubmV4dCgpLmh0bWwoZmlsZXMuam9pbignIDogJykpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdCQoZG9jdW1lbnQpLm9uKCdzdGF0aW86Z2xvYmFsOnJlbmRlclJlc3BvbnNlJywgZnVuY3Rpb24gKGV2ZW50LCBiYXNlLCBjb250ZXgpIHtcclxuXHRcdGJhc2UuZWFjaChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFZpd0ZpbGUuY2FsbCh0aGlzKTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cdFZpd0ZpbGUuY2FsbChkb2N1bWVudCk7XHJcbn0pKCk7Il19